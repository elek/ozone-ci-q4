<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report.xsd" name="org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures" time="480.836" tests="5" errors="5" skipped="0" failures="0">
  <properties>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/workdir/hadoop-ozone/integration-test/target/test-classes:/workdir/hadoop-ozone/integration-test/target/classes:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-common/0.5.0-SNAPSHOT/hadoop-ozone-common-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/user/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-common/3.2.0/hadoop-common-3.2.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.2.0/hadoop-hdfs-3.2.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.2.0/hadoop-hdfs-client-3.2.0.jar:/home/user/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.9.9/jackson-annotations-2.9.9.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-common/0.5.0-SNAPSHOT/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/javax/annotation/javax.annotation-api/1.2/javax.annotation-api-1.2.jar:/home/user/.m2/repository/org/apache/ratis/ratis-server/0.5.0-201fc85-SNAPSHOT/ratis-server-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/0.2.0/ratis-thirdparty-misc-0.2.0.jar:/home/user/.m2/repository/org/apache/ratis/ratis-proto/0.5.0-201fc85-SNAPSHOT/ratis-proto-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-common/0.5.0-201fc85-SNAPSHOT/ratis-common-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-client/0.5.0-201fc85-SNAPSHOT/ratis-client-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-metrics/0.5.0-201fc85-SNAPSHOT/ratis-metrics-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/user/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.2.5/metrics-jvm-3.2.5.jar:/home/user/.m2/repository/io/dropwizard/metrics/metrics-ganglia/3.2.5/metrics-ganglia-3.2.5.jar:/home/user/.m2/repository/info/ganglia/gmetric4j/gmetric4j/1.0.7/gmetric4j-1.0.7.jar:/home/user/.m2/repository/org/apache/ratis/ratis-netty/0.5.0-201fc85-SNAPSHOT/ratis-netty-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-grpc/0.5.0-201fc85-SNAPSHOT/ratis-grpc-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/rocksdb/rocksdbjni/6.0.1/rocksdbjni-6.0.1.jar:/home/user/.m2/repository/org/apache/logging/log4j/log4j-api/2.11.0/log4j-api-2.11.0.jar:/home/user/.m2/repository/org/apache/logging/log4j/log4j-core/2.11.0/log4j-core-2.11.0.jar:/home/user/.m2/repository/com/lmax/disruptor/3.4.2/disruptor-3.4.2.jar:/home/user/.m2/repository/org/apache/commons/commons-pool2/2.6.0/commons-pool2-2.6.0.jar:/home/user/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.60/bcpkix-jdk15on-1.60.jar:/home/user/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/user/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-client/0.34.0/jaeger-client-0.34.0.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-thrift/0.34.0/jaeger-thrift-0.34.0.jar:/home/user/.m2/repository/org/apache/thrift/libthrift/0.12.0/libthrift-0.12.0.jar:/home/user/.m2/repository/com/squareup/okhttp3/okhttp/3.9.0/okhttp-3.9.0.jar:/home/user/.m2/repository/com/squareup/okio/okio/1.13.0/okio-1.13.0.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-core/0.34.0/jaeger-core-0.34.0.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-tracerresolver/0.34.0/jaeger-tracerresolver-0.34.0.jar:/home/user/.m2/repository/io/opentracing/contrib/opentracing-tracerresolver/0.1.5/opentracing-tracerresolver-0.1.5.jar:/home/user/.m2/repository/io/opentracing/opentracing-util/0.31.0/opentracing-util-0.31.0.jar:/home/user/.m2/repository/io/opentracing/opentracing-api/0.31.0/opentracing-api-0.31.0.jar:/home/user/.m2/repository/io/opentracing/opentracing-noop/0.31.0/opentracing-noop-0.31.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-server-framework/0.5.0-SNAPSHOT/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-client/0.5.0-SNAPSHOT/hadoop-hdds-client-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-tools/0.5.0-SNAPSHOT/hadoop-hdds-tools-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-server-scm/0.5.0-SNAPSHOT/hadoop-hdds-server-scm-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-docs/0.5.0-SNAPSHOT/hadoop-hdds-docs-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/io/dropwizard/metrics/metrics-core/3.2.4/metrics-core-3.2.4.jar:/home/user/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/user/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.60/bcprov-jdk15on-1.60.jar:/home/user/.m2/repository/info/picocli/picocli/3.9.6/picocli-3.9.6.jar:/home/user/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/user/.m2/repository/com/google/guava/guava/11.0.2/guava-11.0.2.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-ozone-manager/0.5.0-SNAPSHOT/hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-minikdc/3.2.0/hadoop-minikdc-3.2.0.jar:/home/user/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/user/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/user/.m2/repository/org/slf4j/slf4j-log4j12/1.7.25/slf4j-log4j12-1.7.25.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-s3gateway/0.5.0-SNAPSHOT/hadoop-ozone-s3gateway-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/jboss/weld/servlet/weld-servlet/2.4.7.Final/weld-servlet-2.4.7.Final.jar:/home/user/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.27/jersey-container-servlet-core-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/external/javax.inject/2.5.0-b42/javax.inject-2.5.0-b42.jar:/home/user/.m2/repository/org/glassfish/jersey/core/jersey-common/2.27/jersey-common-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/user/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/user/.m2/repository/org/glassfish/jersey/ext/cdi/jersey-cdi1x/2.27/jersey-cdi1x-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.27/jersey-hk2-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/hk2-locator/2.5.0-b42/hk2-locator-2.5.0-b42.jar:/home/user/.m2/repository/org/javassist/javassist/3.22.0-CR2/javassist-3.22.0-CR2.jar:/home/user/.m2/repository/org/glassfish/hk2/hk2-api/2.5.0/hk2-api-2.5.0.jar:/home/user/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.5.0/jakarta.inject-2.5.0.jar:/home/user/.m2/repository/org/glassfish/hk2/hk2-utils/2.5.0/hk2-utils-2.5.0.jar:/home/user/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.4/jakarta.annotation-api-1.3.4.jar:/home/user/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.5.0/aopalliance-repackaged-2.5.0.jar:/home/user/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-xml/2.9.0/jackson-dataformat-xml-2.9.0.jar:/home/user/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.9.9/jackson-core-2.9.9.jar:/home/user/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.9.9/jackson-module-jaxb-annotations-2.9.9.jar:/home/user/.m2/repository/javax/enterprise/cdi-api/1.2/cdi-api-1.2.jar:/home/user/.m2/repository/javax/el/javax.el-api/3.0.0/javax.el-api-3.0.0.jar:/home/user/.m2/repository/javax/interceptor/javax.interceptor-api/1.2/javax.interceptor-api-1.2.jar:/home/user/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/user/.m2/repository/com/sun/xml/bind/jaxb-impl/2.3.0.1/jaxb-impl-2.3.0.1.jar:/home/user/.m2/repository/com/sun/xml/bind/jaxb-core/2.3.0.1/jaxb-core-2.3.0.1.jar:/home/user/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar:/home/user/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-csi/0.5.0-SNAPSHOT/hadoop-ozone-csi-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/com/google/protobuf/protobuf-java-util/3.5.1/protobuf-java-util-3.5.1.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-config/0.5.0-SNAPSHOT/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/io/grpc/grpc-netty/1.17.1/grpc-netty-1.17.1.jar:/home/user/.m2/repository/io/grpc/grpc-core/1.17.1/grpc-core-1.17.1.jar:/home/user/.m2/repository/io/grpc/grpc-context/1.17.1/grpc-context-1.17.1.jar:/home/user/.m2/repository/com/google/errorprone/error_prone_annotations/2.2.0/error_prone_annotations-2.2.0.jar:/home/user/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.17/animal-sniffer-annotations-1.17.jar:/home/user/.m2/repository/io/opencensus/opencensus-api/0.17.0/opencensus-api-0.17.0.jar:/home/user/.m2/repository/io/opencensus/opencensus-contrib-grpc-metrics/0.17.0/opencensus-contrib-grpc-metrics-0.17.0.jar:/home/user/.m2/repository/io/netty/netty-codec-http2/4.1.30.Final/netty-codec-http2-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-codec-http/4.1.30.Final/netty-codec-http-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-codec/4.1.30.Final/netty-codec-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-handler/4.1.30.Final/netty-handler-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-handler-proxy/4.1.30.Final/netty-handler-proxy-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-codec-socks/4.1.30.Final/netty-codec-socks-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-transport-native-epoll/4.1.30.Final/netty-transport-native-epoll-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-common/4.1.30.Final/netty-common-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-buffer/4.1.30.Final/netty-buffer-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-transport/4.1.30.Final/netty-transport-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-resolver/4.1.30.Final/netty-resolver-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.30.Final/netty-transport-native-unix-common-4.1.30.Final.jar:/home/user/.m2/repository/io/grpc/grpc-protobuf/1.17.1/grpc-protobuf-1.17.1.jar:/home/user/.m2/repository/com/google/api/grpc/proto-google-common-protos/1.0.0/proto-google-common-protos-1.0.0.jar:/home/user/.m2/repository/io/grpc/grpc-protobuf-lite/1.17.1/grpc-protobuf-lite-1.17.1.jar:/home/user/.m2/repository/io/grpc/grpc-stub/1.17.1/grpc-stub-1.17.1.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-recon/0.5.0-SNAPSHOT/hadoop-ozone-recon-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-reconcodegen/0.5.0-SNAPSHOT/hadoop-ozone-reconcodegen-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/com/google/inject/extensions/guice-multibindings/4.0/guice-multibindings-4.0.jar:/home/user/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/user/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/user/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/user/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.27/jersey-container-servlet-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/guice-bridge/2.5.0/guice-bridge-2.5.0.jar:/home/user/.m2/repository/org/glassfish/jersey/core/jersey-server/2.27/jersey-server-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/core/jersey-client/2.27/jersey-client-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.27/jersey-media-jaxb-2.27.jar:/home/user/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/user/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.27/jersey-media-json-jackson-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.27/jersey-entity-filtering-2.27.jar:/home/user/.m2/repository/com/google/inject/extensions/guice-assistedinject/4.0/guice-assistedinject-4.0.jar:/home/user/.m2/repository/org/jooq/jooq/3.11.10/jooq-3.11.10.jar:/home/user/.m2/repository/org/jooq/jooq-meta/3.11.10/jooq-meta-3.11.10.jar:/home/user/.m2/repository/org/jooq/jooq-codegen/3.11.10/jooq-codegen-3.11.10.jar:/home/user/.m2/repository/com/jolbox/bonecp/0.8.0.RELEASE/bonecp-0.8.0.RELEASE.jar:/home/user/.m2/repository/org/xerial/sqlite-jdbc/3.25.2/sqlite-jdbc-3.25.2.jar:/home/user/.m2/repository/org/springframework/spring-jdbc/5.1.3.RELEASE/spring-jdbc-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-beans/5.1.3.RELEASE/spring-beans-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-core/5.1.3.RELEASE/spring-core-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-jcl/5.1.3.RELEASE/spring-jcl-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-tx/5.1.3.RELEASE/spring-tx-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-client/0.5.0-SNAPSHOT/hadoop-ozone-client-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-ozone-manager/0.5.0-SNAPSHOT/hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT-tests.jar:/home/user/.m2/repository/junit/junit/4.11/junit-4.11.jar:/home/user/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/user/.m2/repository/org/openjdk/jmh/jmh-core/1.19/jmh-core-1.19.jar:/home/user/.m2/repository/net/sf/jopt-simple/jopt-simple/4.6/jopt-simple-4.6.jar:/home/user/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/user/.m2/repository/org/openjdk/jmh/jmh-generator-annprocess/1.19/jmh-generator-annprocess-1.19.jar:/home/user/.m2/repository/org/mockito/mockito-all/1.8.5/mockito-all-1.8.5.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-kms/3.2.0/hadoop-kms-3.2.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-auth/3.2.0/hadoop-auth-3.2.0.jar:/home/user/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/user/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/user/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/user/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/user/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/user/.m2/repository/org/apache/curator/curator-framework/2.12.0/curator-framework-2.12.0.jar:/home/user/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/user/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/user/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/user/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-server/9.3.25.v20180904/jetty-server-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-http/9.3.25.v20180904/jetty-http-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-io/9.3.25.v20180904/jetty-io-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.25.v20180904/jetty-webapp-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.25.v20180904/jetty-xml-9.3.25.v20180904.jar:/home/user/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/user/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar:/home/user/.m2/repository/org/slf4j/jul-to-slf4j/1.7.25/jul-to-slf4j-1.7.25.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-util/9.3.25.v20180904/jetty-util-9.3.25.v20180904.jar:/home/user/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.9.9/jackson-databind-2.9.9.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-kms/3.2.0/hadoop-kms-3.2.0-tests.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-server-scm/0.5.0-SNAPSHOT/hadoop-hdds-server-scm-0.5.0-SNAPSHOT-tests.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT-tests.jar:/home/user/.m2/repository/org/yaml/snakeyaml/1.16/snakeyaml-1.16.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-common/3.2.0/hadoop-common-3.2.0-tests.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-annotations/3.2.0/hadoop-annotations-3.2.0.jar:/usr/lib/jvm/java-1.8-openjdk/jre/../lib/tools.jar:/home/user/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/user/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/user/.m2/repository/org/apache/httpcomponents/httpcore/4.4.4/httpcore-4.4.4.jar:/home/user/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/user/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/user/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.25.v20180904/jetty-servlet-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-security/9.3.25.v20180904/jetty-security-9.3.25.v20180904.jar:/home/user/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/user/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/user/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/user/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.13/jackson-jaxrs-1.9.13.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.13/jackson-xc-1.9.13.jar:/home/user/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/user/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/user/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/user/.m2/repository/org/apache/commons/commons-lang3/3.7/commons-lang3-3.7.jar:/home/user/.m2/repository/org/apache/commons/commons-text/1.4/commons-text-1.4.jar:/home/user/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/user/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/user/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/user/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/user/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/user/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/user/.m2/repository/org/apache/curator/curator-client/2.12.0/curator-client-2.12.0.jar:/home/user/.m2/repository/org/apache/curator/curator-recipes/2.12.0/curator-recipes-2.12.0.jar:/home/user/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/user/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/user/.m2/repository/org/apache/zookeeper/zookeeper/3.4.13/zookeeper-3.4.13.jar:/home/user/.m2/repository/jline/jline/0.9.94/jline-0.9.94.jar:/home/user/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/user/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/user/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/user/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.2.0/hadoop-hdfs-3.2.0-tests.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.25.v20180904/jetty-util-ajax-9.3.25.v20180904.jar:/home/user/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/user/.m2/repository/io/netty/netty/3.10.5.Final/netty-3.10.5.Final.jar:/home/user/.m2/repository/io/netty/netty-all/4.0.52.Final/netty-all-4.0.52.Final.jar:/home/user/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:"/>
    <property name="java.vm.vendor" value="IcedTea"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="test.build.dir" value="/workdir/hadoop-ozone/integration-test/target/test-dir"/>
    <property name="test.cache.data" value=""/>
    <property name="java.vendor.url" value="https://icedtea.classpath.org"/>
    <property name="user.timezone" value=""/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="test.build.data" value="/workdir/hadoop-ozone/integration-test/target/test-dir"/>
    <property name="user.country" value="US"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64"/>
    <property name="sun.java.command" value="/workdir/hadoop-ozone/integration-test/target/surefire/surefirebooter5298615103394072061.jar /workdir/hadoop-ozone/integration-test/target/surefire 2019-10-02T06-52-48_325-jvmRun1 surefire4751994433012099767tmp surefire_762050206885349636382tmp"/>
    <property name="test" value="!TestMiniChaosOzoneCluster"/>
    <property name="surefire.test.class.path" value="/workdir/hadoop-ozone/integration-test/target/test-classes:/workdir/hadoop-ozone/integration-test/target/classes:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-common/0.5.0-SNAPSHOT/hadoop-ozone-common-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/user/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-common/3.2.0/hadoop-common-3.2.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.2.0/hadoop-hdfs-3.2.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.2.0/hadoop-hdfs-client-3.2.0.jar:/home/user/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.9.9/jackson-annotations-2.9.9.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-common/0.5.0-SNAPSHOT/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/javax/annotation/javax.annotation-api/1.2/javax.annotation-api-1.2.jar:/home/user/.m2/repository/org/apache/ratis/ratis-server/0.5.0-201fc85-SNAPSHOT/ratis-server-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-thirdparty-misc/0.2.0/ratis-thirdparty-misc-0.2.0.jar:/home/user/.m2/repository/org/apache/ratis/ratis-proto/0.5.0-201fc85-SNAPSHOT/ratis-proto-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-common/0.5.0-201fc85-SNAPSHOT/ratis-common-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-client/0.5.0-201fc85-SNAPSHOT/ratis-client-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-metrics/0.5.0-201fc85-SNAPSHOT/ratis-metrics-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/user/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.2.5/metrics-jvm-3.2.5.jar:/home/user/.m2/repository/io/dropwizard/metrics/metrics-ganglia/3.2.5/metrics-ganglia-3.2.5.jar:/home/user/.m2/repository/info/ganglia/gmetric4j/gmetric4j/1.0.7/gmetric4j-1.0.7.jar:/home/user/.m2/repository/org/apache/ratis/ratis-netty/0.5.0-201fc85-SNAPSHOT/ratis-netty-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/ratis/ratis-grpc/0.5.0-201fc85-SNAPSHOT/ratis-grpc-0.5.0-201fc85-SNAPSHOT.jar:/home/user/.m2/repository/org/rocksdb/rocksdbjni/6.0.1/rocksdbjni-6.0.1.jar:/home/user/.m2/repository/org/apache/logging/log4j/log4j-api/2.11.0/log4j-api-2.11.0.jar:/home/user/.m2/repository/org/apache/logging/log4j/log4j-core/2.11.0/log4j-core-2.11.0.jar:/home/user/.m2/repository/com/lmax/disruptor/3.4.2/disruptor-3.4.2.jar:/home/user/.m2/repository/org/apache/commons/commons-pool2/2.6.0/commons-pool2-2.6.0.jar:/home/user/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.60/bcpkix-jdk15on-1.60.jar:/home/user/.m2/repository/commons-validator/commons-validator/1.6/commons-validator-1.6.jar:/home/user/.m2/repository/commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-client/0.34.0/jaeger-client-0.34.0.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-thrift/0.34.0/jaeger-thrift-0.34.0.jar:/home/user/.m2/repository/org/apache/thrift/libthrift/0.12.0/libthrift-0.12.0.jar:/home/user/.m2/repository/com/squareup/okhttp3/okhttp/3.9.0/okhttp-3.9.0.jar:/home/user/.m2/repository/com/squareup/okio/okio/1.13.0/okio-1.13.0.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-core/0.34.0/jaeger-core-0.34.0.jar:/home/user/.m2/repository/io/jaegertracing/jaeger-tracerresolver/0.34.0/jaeger-tracerresolver-0.34.0.jar:/home/user/.m2/repository/io/opentracing/contrib/opentracing-tracerresolver/0.1.5/opentracing-tracerresolver-0.1.5.jar:/home/user/.m2/repository/io/opentracing/opentracing-util/0.31.0/opentracing-util-0.31.0.jar:/home/user/.m2/repository/io/opentracing/opentracing-api/0.31.0/opentracing-api-0.31.0.jar:/home/user/.m2/repository/io/opentracing/opentracing-noop/0.31.0/opentracing-noop-0.31.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-server-framework/0.5.0-SNAPSHOT/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-client/0.5.0-SNAPSHOT/hadoop-hdds-client-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-tools/0.5.0-SNAPSHOT/hadoop-hdds-tools-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-server-scm/0.5.0-SNAPSHOT/hadoop-hdds-server-scm-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-docs/0.5.0-SNAPSHOT/hadoop-hdds-docs-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/io/dropwizard/metrics/metrics-core/3.2.4/metrics-core-3.2.4.jar:/home/user/.m2/repository/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar:/home/user/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.60/bcprov-jdk15on-1.60.jar:/home/user/.m2/repository/info/picocli/picocli/3.9.6/picocli-3.9.6.jar:/home/user/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar:/home/user/.m2/repository/com/google/guava/guava/11.0.2/guava-11.0.2.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-ozone-manager/0.5.0-SNAPSHOT/hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-minikdc/3.2.0/hadoop-minikdc-3.2.0.jar:/home/user/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/user/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/user/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/user/.m2/repository/org/slf4j/slf4j-log4j12/1.7.25/slf4j-log4j12-1.7.25.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-s3gateway/0.5.0-SNAPSHOT/hadoop-ozone-s3gateway-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/jboss/weld/servlet/weld-servlet/2.4.7.Final/weld-servlet-2.4.7.Final.jar:/home/user/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet-core/2.27/jersey-container-servlet-core-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/external/javax.inject/2.5.0-b42/javax.inject-2.5.0-b42.jar:/home/user/.m2/repository/org/glassfish/jersey/core/jersey-common/2.27/jersey-common-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/osgi-resource-locator/1.0.1/osgi-resource-locator-1.0.1.jar:/home/user/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.1/javax.ws.rs-api-2.1.jar:/home/user/.m2/repository/org/glassfish/jersey/ext/cdi/jersey-cdi1x/2.27/jersey-cdi1x-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/inject/jersey-hk2/2.27/jersey-hk2-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/hk2-locator/2.5.0-b42/hk2-locator-2.5.0-b42.jar:/home/user/.m2/repository/org/javassist/javassist/3.22.0-CR2/javassist-3.22.0-CR2.jar:/home/user/.m2/repository/org/glassfish/hk2/hk2-api/2.5.0/hk2-api-2.5.0.jar:/home/user/.m2/repository/org/glassfish/hk2/external/jakarta.inject/2.5.0/jakarta.inject-2.5.0.jar:/home/user/.m2/repository/org/glassfish/hk2/hk2-utils/2.5.0/hk2-utils-2.5.0.jar:/home/user/.m2/repository/jakarta/annotation/jakarta.annotation-api/1.3.4/jakarta.annotation-api-1.3.4.jar:/home/user/.m2/repository/org/glassfish/hk2/external/aopalliance-repackaged/2.5.0/aopalliance-repackaged-2.5.0.jar:/home/user/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-xml/2.9.0/jackson-dataformat-xml-2.9.0.jar:/home/user/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.9.9/jackson-core-2.9.9.jar:/home/user/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.9.9/jackson-module-jaxb-annotations-2.9.9.jar:/home/user/.m2/repository/javax/enterprise/cdi-api/1.2/cdi-api-1.2.jar:/home/user/.m2/repository/javax/el/javax.el-api/3.0.0/javax.el-api-3.0.0.jar:/home/user/.m2/repository/javax/interceptor/javax.interceptor-api/1.2/javax.interceptor-api-1.2.jar:/home/user/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/user/.m2/repository/com/sun/xml/bind/jaxb-impl/2.3.0.1/jaxb-impl-2.3.0.1.jar:/home/user/.m2/repository/com/sun/xml/bind/jaxb-core/2.3.0.1/jaxb-core-2.3.0.1.jar:/home/user/.m2/repository/javax/xml/bind/jaxb-api/2.3.0/jaxb-api-2.3.0.jar:/home/user/.m2/repository/javax/activation/activation/1.1.1/activation-1.1.1.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-csi/0.5.0-SNAPSHOT/hadoop-ozone-csi-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/com/google/protobuf/protobuf-java-util/3.5.1/protobuf-java-util-3.5.1.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-config/0.5.0-SNAPSHOT/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/io/grpc/grpc-netty/1.17.1/grpc-netty-1.17.1.jar:/home/user/.m2/repository/io/grpc/grpc-core/1.17.1/grpc-core-1.17.1.jar:/home/user/.m2/repository/io/grpc/grpc-context/1.17.1/grpc-context-1.17.1.jar:/home/user/.m2/repository/com/google/errorprone/error_prone_annotations/2.2.0/error_prone_annotations-2.2.0.jar:/home/user/.m2/repository/org/codehaus/mojo/animal-sniffer-annotations/1.17/animal-sniffer-annotations-1.17.jar:/home/user/.m2/repository/io/opencensus/opencensus-api/0.17.0/opencensus-api-0.17.0.jar:/home/user/.m2/repository/io/opencensus/opencensus-contrib-grpc-metrics/0.17.0/opencensus-contrib-grpc-metrics-0.17.0.jar:/home/user/.m2/repository/io/netty/netty-codec-http2/4.1.30.Final/netty-codec-http2-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-codec-http/4.1.30.Final/netty-codec-http-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-codec/4.1.30.Final/netty-codec-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-handler/4.1.30.Final/netty-handler-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-handler-proxy/4.1.30.Final/netty-handler-proxy-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-codec-socks/4.1.30.Final/netty-codec-socks-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-transport-native-epoll/4.1.30.Final/netty-transport-native-epoll-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-common/4.1.30.Final/netty-common-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-buffer/4.1.30.Final/netty-buffer-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-transport/4.1.30.Final/netty-transport-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-resolver/4.1.30.Final/netty-resolver-4.1.30.Final.jar:/home/user/.m2/repository/io/netty/netty-transport-native-unix-common/4.1.30.Final/netty-transport-native-unix-common-4.1.30.Final.jar:/home/user/.m2/repository/io/grpc/grpc-protobuf/1.17.1/grpc-protobuf-1.17.1.jar:/home/user/.m2/repository/com/google/api/grpc/proto-google-common-protos/1.0.0/proto-google-common-protos-1.0.0.jar:/home/user/.m2/repository/io/grpc/grpc-protobuf-lite/1.17.1/grpc-protobuf-lite-1.17.1.jar:/home/user/.m2/repository/io/grpc/grpc-stub/1.17.1/grpc-stub-1.17.1.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-recon/0.5.0-SNAPSHOT/hadoop-ozone-recon-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-reconcodegen/0.5.0-SNAPSHOT/hadoop-ozone-reconcodegen-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/com/google/inject/extensions/guice-multibindings/4.0/guice-multibindings-4.0.jar:/home/user/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/user/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/user/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/user/.m2/repository/org/glassfish/jersey/containers/jersey-container-servlet/2.27/jersey-container-servlet-2.27.jar:/home/user/.m2/repository/org/glassfish/hk2/guice-bridge/2.5.0/guice-bridge-2.5.0.jar:/home/user/.m2/repository/org/glassfish/jersey/core/jersey-server/2.27/jersey-server-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/core/jersey-client/2.27/jersey-client-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/media/jersey-media-jaxb/2.27/jersey-media-jaxb-2.27.jar:/home/user/.m2/repository/javax/validation/validation-api/1.1.0.Final/validation-api-1.1.0.Final.jar:/home/user/.m2/repository/org/glassfish/jersey/media/jersey-media-json-jackson/2.27/jersey-media-json-jackson-2.27.jar:/home/user/.m2/repository/org/glassfish/jersey/ext/jersey-entity-filtering/2.27/jersey-entity-filtering-2.27.jar:/home/user/.m2/repository/com/google/inject/extensions/guice-assistedinject/4.0/guice-assistedinject-4.0.jar:/home/user/.m2/repository/org/jooq/jooq/3.11.10/jooq-3.11.10.jar:/home/user/.m2/repository/org/jooq/jooq-meta/3.11.10/jooq-meta-3.11.10.jar:/home/user/.m2/repository/org/jooq/jooq-codegen/3.11.10/jooq-codegen-3.11.10.jar:/home/user/.m2/repository/com/jolbox/bonecp/0.8.0.RELEASE/bonecp-0.8.0.RELEASE.jar:/home/user/.m2/repository/org/xerial/sqlite-jdbc/3.25.2/sqlite-jdbc-3.25.2.jar:/home/user/.m2/repository/org/springframework/spring-jdbc/5.1.3.RELEASE/spring-jdbc-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-beans/5.1.3.RELEASE/spring-beans-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-core/5.1.3.RELEASE/spring-core-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-jcl/5.1.3.RELEASE/spring-jcl-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/springframework/spring-tx/5.1.3.RELEASE/spring-tx-5.1.3.RELEASE.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-client/0.5.0-SNAPSHOT/hadoop-ozone-client-0.5.0-SNAPSHOT.jar:/home/user/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-ozone-ozone-manager/0.5.0-SNAPSHOT/hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT-tests.jar:/home/user/.m2/repository/junit/junit/4.11/junit-4.11.jar:/home/user/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/user/.m2/repository/org/openjdk/jmh/jmh-core/1.19/jmh-core-1.19.jar:/home/user/.m2/repository/net/sf/jopt-simple/jopt-simple/4.6/jopt-simple-4.6.jar:/home/user/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/user/.m2/repository/org/openjdk/jmh/jmh-generator-annprocess/1.19/jmh-generator-annprocess-1.19.jar:/home/user/.m2/repository/org/mockito/mockito-all/1.8.5/mockito-all-1.8.5.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-kms/3.2.0/hadoop-kms-3.2.0.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-auth/3.2.0/hadoop-auth-3.2.0.jar:/home/user/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/user/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/user/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/user/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/user/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/user/.m2/repository/org/apache/curator/curator-framework/2.12.0/curator-framework-2.12.0.jar:/home/user/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/user/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/user/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/user/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-server/9.3.25.v20180904/jetty-server-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-http/9.3.25.v20180904/jetty-http-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-io/9.3.25.v20180904/jetty-io-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.25.v20180904/jetty-webapp-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.25.v20180904/jetty-xml-9.3.25.v20180904.jar:/home/user/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/user/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar:/home/user/.m2/repository/org/slf4j/jul-to-slf4j/1.7.25/jul-to-slf4j-1.7.25.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-util/9.3.25.v20180904/jetty-util-9.3.25.v20180904.jar:/home/user/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.9.9/jackson-databind-2.9.9.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-kms/3.2.0/hadoop-kms-3.2.0-tests.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-server-scm/0.5.0-SNAPSHOT/hadoop-hdds-server-scm-0.5.0-SNAPSHOT-tests.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT-tests.jar:/home/user/.m2/repository/org/yaml/snakeyaml/1.16/snakeyaml-1.16.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-common/3.2.0/hadoop-common-3.2.0-tests.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-annotations/3.2.0/hadoop-annotations-3.2.0.jar:/usr/lib/jvm/java-1.8-openjdk/jre/../lib/tools.jar:/home/user/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/user/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/user/.m2/repository/org/apache/httpcomponents/httpcore/4.4.4/httpcore-4.4.4.jar:/home/user/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/user/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/user/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.25.v20180904/jetty-servlet-9.3.25.v20180904.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-security/9.3.25.v20180904/jetty-security-9.3.25.v20180904.jar:/home/user/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/user/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/user/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/user/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.13/jackson-jaxrs-1.9.13.jar:/home/user/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.13/jackson-xc-1.9.13.jar:/home/user/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/user/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/user/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/user/.m2/repository/org/apache/commons/commons-lang3/3.7/commons-lang3-3.7.jar:/home/user/.m2/repository/org/apache/commons/commons-text/1.4/commons-text-1.4.jar:/home/user/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/user/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/user/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/user/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/user/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/user/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/user/.m2/repository/org/apache/curator/curator-client/2.12.0/curator-client-2.12.0.jar:/home/user/.m2/repository/org/apache/curator/curator-recipes/2.12.0/curator-recipes-2.12.0.jar:/home/user/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/user/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/user/.m2/repository/org/apache/zookeeper/zookeeper/3.4.13/zookeeper-3.4.13.jar:/home/user/.m2/repository/jline/jline/0.9.94/jline-0.9.94.jar:/home/user/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/user/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/user/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/user/.m2/repository/dnsjava/dnsjava/2.1.7/dnsjava-2.1.7.jar:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.2.0/hadoop-hdfs-3.2.0-tests.jar:/home/user/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.25.v20180904/jetty-util-ajax-9.3.25.v20180904.jar:/home/user/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/user/.m2/repository/io/netty/netty/3.10.5.Final/netty-3.10.5.Final.jar:/home/user/.m2/repository/io/netty/netty-all/4.0.52.Final/netty-all-4.0.52.Final.jar:/home/user/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/user"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="java.home" value="/usr/lib/jvm/java-1.8-openjdk/jre"/>
    <property name="java.security.krb5.conf" value="/workdir/hadoop-ozone/integration-test/target/test-classes/krb5.conf"/>
    <property name="basedir" value="/workdir/hadoop-ozone/integration-test"/>
    <property name="file.separator" value="/"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="surefire.real.class.path" value="/workdir/hadoop-ozone/integration-test/target/surefire/surefirebooter5298615103394072061.jar"/>
    <property name="hadoop.log.dir" value="/workdir/hadoop-ozone/integration-test/target/log"/>
    <property name="sun.boot.class.path" value="/usr/lib/jvm/java-1.8-openjdk/jre/lib/resources.jar:/usr/lib/jvm/java-1.8-openjdk/jre/lib/rt.jar:/usr/lib/jvm/java-1.8-openjdk/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-1.8-openjdk/jre/lib/jsse.jar:/usr/lib/jvm/java-1.8-openjdk/jre/lib/jce.jar:/usr/lib/jvm/java-1.8-openjdk/jre/lib/charsets.jar:/usr/lib/jvm/java-1.8-openjdk/jre/lib/jfr.jar:/usr/lib/jvm/java-1.8-openjdk/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_212-b04"/>
    <property name="java.net.preferIPv4Stack" value="true"/>
    <property name="user.name" value="jenkins1000"/>
    <property name="path.separator" value=":"/>
    <property name="java.security.egd" value="file:///dev/urandom"/>
    <property name="os.version" value="3.10.0-957.12.2.el7.x86_64"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/java-1.8-openjdk/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="test.build.webapps" value=""/>
    <property name="localRepository" value="/home/user/.m2/repository"/>
    <property name="java.vendor.url.bug" value="https://icedtea.classpath.org/bugzilla"/>
    <property name="java.io.tmpdir" value="/tmp"/>
    <property name="require.test.libhadoop" value=""/>
    <property name="java.version" value="1.8.0_212"/>
    <property name="user.dir" value="/workdir/hadoop-ozone/integration-test"/>
    <property name="os.arch" value="amd64"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="test.build.classes" value="/workdir/hadoop-ozone/integration-test/target/test-classes"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="hadoop.tmp.dir" value="/workdir/hadoop-ozone/integration-test/target/tmp"/>
    <property name="java.library.path" value="/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64/server:/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64:/usr/lib/jvm/java-1.8-openjdk/jre/../lib/amd64:/workdir/hadoop-ozone/integration-test/target/native/target/usr/local/lib:/workdir/hadoop-ozone/integration-test/../../hadoop-common-project/hadoop-common/target/native/target/usr/local/lib:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vendor" value="IcedTea"/>
    <property name="java.vm.version" value="25.212-b04"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/java-1.8-openjdk/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testValidateBCSIDOnDnRestart" classname="org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures" time="50.089">
    <error message="Allocated 0 blocks. Requested 1 blocks" type="INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException">INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocated 0 blocks. Requested 1 blocks
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:732)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.allocateBlock(OzoneManagerProtocolClientSideTranslatorPB.java:764)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66)
	at com.sun.proxy.$Proxy37.allocateBlock(Unknown Source)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateNewBlock(BlockOutputStreamEntryPool.java:248)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateBlockIfNeeded(BlockOutputStreamEntryPool.java:296)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:198)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleRetry(KeyOutputStream.java:375)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleException(KeyOutputStream.java:324)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleFlushOrClose(KeyOutputStream.java:449)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.flush(KeyOutputStream.java:397)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.flush(OzoneOutputStream.java:54)
	at org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures.testValidateBCSIDOnDnRestart(TestContainerStateMachineFailures.java:429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
</error>
    <system-out><![CDATA[2019-10-02 11:53:17,161 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:17,259 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:17,262 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:17,279 [main] INFO  util.log (Log.java:initialized(192)) - Logging initialized @870ms
2019-10-02 11:53:17,371 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-10-02 11:53:17,371 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-10-02 11:53:17,371 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-10-02 11:53:17,372 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-10-02 11:53:17,372 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-10-02 11:53:17,372 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-10-02 11:53:17,382 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-10-02 11:53:17,382 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-10-02 11:53:17,384 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-10-02 11:53:17,679 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@1aafa419
2019-10-02 11:53:17,681 [main] INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-10-02 11:53:17,745 [main] INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(114)) - Entering startup safe mode.
2019-10-02 11:53:17,814 [main] INFO  algorithms.ContainerPlacementPolicyFactory (ContainerPlacementPolicyFactory.java:getPolicy(57)) - Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRandom
2019-10-02 11:53:17,829 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:17,936 [main] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(132)) - No pipeline exists in current db
2019-10-02 11:53:17,939 [main] WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:18,077 [main] WARN  events.EventQueue (EventQueue.java:fireEvent(183)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-10-02 11:53:18,459 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-10-02 11:53:18,487 [Socket Reader #1 for port 46617] INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 46617
2019-10-02 11:53:18,621 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-10-02 11:53:18,622 [Socket Reader #1 for port 33744] INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 33744
2019-10-02 11:53:18,631 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-10-02 11:53:18,632 [Socket Reader #1 for port 34741] INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 34741
2019-10-02 11:53:18,653 [main] INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-10-02 11:53:18,791 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-10-02 11:53:18,798 [main] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-10-02 11:53:18,806 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-10-02 11:53:18,808 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-10-02 11:53:18,809 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-10-02 11:53:18,809 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-10-02 11:53:18,837 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:start(770)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:34741
2019-10-02 11:53:18,926 [main] WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(134)) - Cannot locate configuration: tried hadoop-metrics2-storagecontainermanager.properties,hadoop-metrics2.properties
2019-10-02 11:53:18,943 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(374)) - Scheduled Metric snapshot period at 10 second(s).
2019-10-02 11:53:18,943 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - StorageContainerManager metrics system started
2019-10-02 11:53:19,183 [main] INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(150)) - RPC server for Client  is listening at /0.0.0.0:34741
2019-10-02 11:53:19,184 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-10-02 11:53:19,184 [IPC Server listener on 34741] INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 34741: starting
2019-10-02 11:53:19,187 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:start(780)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:33744
2019-10-02 11:53:19,189 [main] INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(146)) - RPC server for Block Protocol is listening at /0.0.0.0:33744
2019-10-02 11:53:19,190 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-10-02 11:53:19,190 [IPC Server listener on 33744] INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 33744: starting
2019-10-02 11:53:19,191 [main] INFO  server.StorageContainerManager (StorageContainerManager.java:start(784)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:46617
2019-10-02 11:53:19,192 [main] INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:46617
2019-10-02 11:53:19,192 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-10-02 11:53:19,192 [IPC Server listener on 46617] INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 46617: starting
2019-10-02 11:53:19,195 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 39062
2019-10-02 11:53:19,197 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
2019-10-02 11:53:19,234 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@158a3b2e{/logs,file:///workdir/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-10-02 11:53:19,235 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5e1fa5b1{/static,file:///workdir/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-10-02 11:53:19,268 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@61edc883{/,file:///workdir/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-10-02 11:53:19,275 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@780ec4a5{HTTP/1.1,[http/1.1]}{0.0.0.0:39062}
2019-10-02 11:53:19,275 [main] INFO  server.Server (Server.java:doStart(419)) - Started @2867ms
2019-10-02 11:53:19,278 [main] INFO  impl.MetricsSinkAdapter (MetricsSinkAdapter.java:start(204)) - Sink prometheus started
2019-10-02 11:53:19,278 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:registerSink(301)) - Registered sink prometheus
2019-10-02 11:53:19,279 [main] INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(215)) - HTTP server of SCM is listening at http://0.0.0.0:39062
2019-10-02 11:53:19,285 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@1b822fcc] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-10-02 11:53:19,290 [main] WARN  server.ServerUtils (ServerUtils.java:getDBPath(222)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:19,402 [main] WARN  server.ServerUtils (ServerUtils.java:getDBPath(222)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:19,402 [main] WARN  server.ServerUtils (ServerUtils.java:getDBPath(222)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:19,403 [main] INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(652)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-10-02 11:53:19,403 [main] INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(658)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 80a17829-561d-42fe-96bc-db1bd6d1a7d2
2019-10-02 11:53:19,405 [main] INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(609)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-10-02 11:53:20,128 [main] WARN  server.ServerUtils (ServerUtils.java:getDBPath(222)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-10-02 11:53:20,136 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-10-02 11:53:20,136 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-10-02 11:53:20,137 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-10-02 11:53:20,137 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-10-02 11:53:20,137 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-10-02 11:53:20,137 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-10-02 11:53:20,138 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-10-02 11:53:20,138 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-10-02 11:53:20,138 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-10-02 11:53:20,138 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-10-02 11:53:20,139 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-10-02 11:53:20,139 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-10-02 11:53:20,139 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-10-02 11:53:20,139 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-10-02 11:53:20,139 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-10-02 11:53:20,140 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-10-02 11:53:20,140 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-10-02 11:53:20,140 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-10-02 11:53:20,140 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-10-02 11:53:20,140 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-10-02 11:53:20,141 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-10-02 11:53:20,141 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-10-02 11:53:20,141 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-10-02 11:53:20,141 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-10-02 11:53:20,142 [main] INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-10-02 11:53:20,893 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-10-02 11:53:20,894 [Socket Reader #1 for port 38339] INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 38339
2019-10-02 11:53:20,918 [main] INFO  om.OzoneManager (OzoneManager.java:start(1243)) - OzoneManager RPC server is listening at localhost/127.0.0.1:38339
2019-10-02 11:53:20,918 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-10-02 11:53:20,919 [IPC Server listener on 38339] INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 38339: starting
2019-10-02 11:53:20,920 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-10-02 11:53:20,925 [main] INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-10-02 11:53:20,927 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-10-02 11:53:20,928 [main] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-10-02 11:53:20,930 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-10-02 11:53:20,932 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-10-02 11:53:20,932 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-10-02 11:53:20,933 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-10-02 11:53:20,936 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46321
2019-10-02 11:53:20,936 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
2019-10-02 11:53:20,939 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5cf8edcf{/logs,file:///workdir/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-10-02 11:53:20,940 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@629f066f{/static,file:///workdir/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-10-02 11:53:20,947 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1cbb3d3b{/,file:///workdir/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-10-02 11:53:20,948 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@529cfee5{HTTP/1.1,[http/1.1]}{0.0.0.0:46321}
2019-10-02 11:53:20,949 [main] INFO  server.Server (Server.java:doStart(419)) - Started @4540ms
2019-10-02 11:53:20,949 [main] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(276)) - Sink prometheus already exists!
2019-10-02 11:53:20,950 [main] INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(215)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:46321
2019-10-02 11:53:21,244 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-10-02 11:53:21,290 [main] INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(184)) - HddsDatanodeService host:pr-trunk-gg4kw-413187789 ip:192.168.151.92
2019-10-02 11:53:21,320 [main] INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 1482555576320
2019-10-02 11:53:21,322 [main] INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/containers/hdds to VolumeSet
2019-10-02 11:53:21,326 [main] INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(139)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5136207f
2019-10-02 11:53:21,349 [main] INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(202)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5136207f
2019-10-02 11:53:21,467 [main] INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-10-02 11:53:21,532 [main] INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(45)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2019-10-02 11:53:21,537 [main] INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 0 (default)
2019-10-02 11:53:21,537 [main] INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-10-02 11:53:21,539 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:53:21,540 [main] INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-10-02 11:53:21,541 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-10-02 11:53:21,698 [main] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:53:21,770 [main] INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-10-02 11:53:21,771 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-10-02 11:53:21,772 [main] WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-10-02 11:53:21,774 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-10-02 11:53:21,775 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-10-02 11:53:21,775 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-10-02 11:53:21,776 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-10-02 11:53:21,776 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 41770
2019-10-02 11:53:21,777 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
2019-10-02 11:53:21,779 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@43045f9f{/logs,file:///workdir/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-10-02 11:53:21,779 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6403e24c{/static,jar:file:/home/user/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-10-02 11:53:21,814 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5df778c3{/,file:///tmp/jetty-0.0.0.0-41770-hddsDatanode-_-any-2678862960453285984.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-10-02 11:53:21,814 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@895416d{HTTP/1.1,[http/1.1]}{0.0.0.0:41770}
2019-10-02 11:53:21,816 [main] INFO  server.Server (Server.java:doStart(419)) - Started @5407ms
2019-10-02 11:53:21,818 [main] WARN  impl.MetricsSystemImpl (MetricsSystemImpl.java:register(276)) - Sink prometheus already exists!
2019-10-02 11:53:21,819 [main] INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(215)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:41770
2019-10-02 11:53:21,821 [main] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(147)) - Waiting for cluster to be ready. Got 0 of 1 DN Heartbeats.
2019-10-02 11:53:21,825 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@3114902f] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-10-02 11:53:21,945 [Datanode State Machine Thread - 0] INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/meta/datanode.id
2019-10-02 11:53:22,821 [main] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(147)) - Waiting for cluster to be ready. Got 0 of 1 DN Heartbeats.
2019-10-02 11:53:23,822 [main] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(147)) - Waiting for cluster to be ready. Got 0 of 1 DN Heartbeats.
2019-10-02 11:53:23,889 [Datanode State Machine Thread - 0] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(217)) - Attempting to start container services.
2019-10-02 11:53:23,892 [Datanode State Machine Thread - 0] INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(179)) - Background container scanner has been disabled.
2019-10-02 11:53:23,892 [Datanode State Machine Thread - 0] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(417)) - Starting XceiverServerRatis e5813bca-be1b-4833-8967-802e28d44868 at port 0
2019-10-02 11:53:23,916 [Datanode State Machine Thread - 0] INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - e5813bca-be1b-4833-8967-802e28d44868: start RPC server
2019-10-02 11:53:24,041 [Datanode State Machine Thread - 0] INFO  server.GrpcService (GrpcService.java:startImpl(158)) - e5813bca-be1b-4833-8967-802e28d44868: GrpcService started, listening on 0.0.0.0/0.0.0.0:34529
2019-10-02 11:53:24,042 [Datanode State Machine Thread - 0] INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(427)) - XceiverServerRatis e5813bca-be1b-4833-8967-802e28d44868 is started using port 34529
2019-10-02 11:53:24,046 [Datanode State Machine Thread - 0] INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:start(149)) - XceiverServerGrpc e5813bca-be1b-4833-8967-802e28d44868 is started using port 39690
2019-10-02 11:53:24,823 [main] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(147)) - Waiting for cluster to be ready. Got 0 of 1 DN Heartbeats.
2019-10-02 11:53:25,823 [main] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(147)) - Waiting for cluster to be ready. Got 0 of 1 DN Heartbeats.
2019-10-02 11:53:25,855 [IPC Server handler 0 on 46617] INFO  net.NetworkTopology (NetworkTopologyImpl.java:add(111)) - Added a new node: /default-rack/e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:53:25,855 [IPC Server handler 0 on 46617] INFO  node.SCMNodeManager (SCMNodeManager.java:register(266)) - Registered Data node : e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}
2019-10-02 11:53:25,865 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-10-02 11:53:25,866 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-10-02 11:53:25,866 [EventQueue-NodeRegistrationContainerReportForDataNodeSafeModeRule] INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-10-02 11:53:26,366 [grpc-default-executor-0] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-331389209C49:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-331389209C49:java.util.concurrent.CompletableFuture@6df9ffa3[Not completed]
2019-10-02 11:53:26,382 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-331389209C49:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:53:26,385 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:53:26,386 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:53:26,386 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:53:26,387 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:53:26,388 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:53:26,397 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:53:26,397 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:53:26,408 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:53:26,411 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/54c242b2-5048-45b5-832d-331389209c49 does not exist. Creating ...
2019-10-02 11:53:26,441 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/54c242b2-5048-45b5-832d-331389209c49/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:53:26,479 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/54c242b2-5048-45b5-832d-331389209c49 has been successfully formatted.
2019-10-02 11:53:26,482 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-331389209C49: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:53:26,483 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:53:26,485 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:53:26,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:53:26,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:53:26,494 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:53:26,496 [pool-27-thread-1] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - ratis metrics system started (again)
2019-10-02 11:53:26,502 [pool-27-thread-1] INFO  metrics.MetricRegistries (MetricRegistriesLoader.java:load(64)) - Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
2019-10-02 11:53:26,538 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:53:26,544 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/54c242b2-5048-45b5-832d-331389209c49
2019-10-02 11:53:26,545 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:53:26,546 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:53:26,547 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:53:26,548 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:53:26,548 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:53:26,549 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:53:26,549 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:53:26,550 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:53:26,550 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:53:26,560 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:53:26,564 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:53:26,569 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:53:26,569 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:53:26,570 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:53:26,571 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:53:26,605 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:53:26,607 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:53:26,608 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:53:26,610 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-331389209C49,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:53:26,681 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 54c242b2-5048-45b5-832d-331389209c49, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:53:26,824 [main] INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(147)) - Cluster is ready. Got 1 of 1 DN Heartbeats.
2019-10-02 11:53:27,291 [main] INFO  rpc.RpcClient (RpcClient.java:createVolume(276)) - Creating Volume: testcontainerstatemachinefailures, with jenkins1000 as owner.
2019-10-02 11:53:27,401 [IPC Server handler 0 on 38339] INFO  volume.OMVolumeCreateRequest (OMVolumeCreateRequest.java:validateAndUpdateCache(194)) - created volume:testcontainerstatemachinefailures for user:jenkins1000
2019-10-02 11:53:27,418 [main] INFO  rpc.RpcClient (RpcClient.java:createBucket(415)) - Creating Bucket: testcontainerstatemachinefailures/testcontainerstatemachinefailures, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-10-02 11:53:27,799 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - XceiverClientMetrics metrics system started (again)
2019-10-02 11:53:28,871 [Thread-148] INFO  container.ReplicationManager (ReplicationManager.java:start(162)) - Starting Replication Monitor Thread.
2019-10-02 11:53:28,878 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:run(225)) - Replication Monitor Thread took 5 milliseconds for processing 1 containers.
2019-10-02 11:53:31,675 [Thread-150] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-FollowerState: change to CANDIDATE, lastRpcTime:5067ms, electionTimeout:5066ms
2019-10-02 11:53:31,677 [Thread-150] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:53:31,678 [Thread-150] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:53:31,682 [Thread-150] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:53:31,685 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:53:31,687 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:53:31,687 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:53:31,687 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5205ms
2019-10-02 11:53:31,692 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:53:31,692 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:53:31,695 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:53:31,697 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:53:31,697 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:53:31,697 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:53:31,727 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:53:31,748 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:53:31,759 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-LeaderElection1] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:53:31,922 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/54c242b2-5048-45b5-832d-331389209c49/current/log_inprogress_0
2019-10-02 11:53:32,143 [pool-26-thread-1] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:53:32,144 [pool-26-thread-1] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 25b79e815b9471d4:25b79e815b9471d4:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:53:32,159 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #1 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
11:53:32.164 [pool-26-thread-1] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 1 locID: 102892647710195712 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:53:32,178 [pool-26-thread-1] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-331389209C49: writeChunk writeStateMachineData failed: blockIdcontainerID: 1
localID: 102892647710195712
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892647710195712_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:53:32,189 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=54c242b2-5048-45b5-832d-331389209c49.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:53:32,194 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 54c242b2-5048-45b5-832d-331389209c49, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:53:32,194 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 54c242b2-5048-45b5-832d-331389209c49, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:53:32,195 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-10-02 11:53:32,196 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 54c242b2-5048-45b5-832d-331389209c49, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:53:32,199 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-10-02 11:53:42,220 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:53:42,225 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: shutdown
2019-10-02 11:53:42,225 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-331389209C49,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:53:42,226 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:53:42,227 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-PendingRequests: sendNotLeaderResponses
2019-10-02 11:53:42,234 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:53:42,235 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49: closes. applyIndex: 0
2019-10-02 11:53:42,237 [e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:53:42,238 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49-SegmentedRaftLogWorker close()
2019-10-02 11:53:42,255 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 54c242b2-5048-45b5-832d-331389209c49, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:53:42,267 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-2C2B6F442FC7:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-2C2B6F442FC7:java.util.concurrent.CompletableFuture@1bba2c8c[Not completed]
2019-10-02 11:53:42,270 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-2C2B6F442FC7:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:53:42,270 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:53:42,270 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:53:42,270 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:53:42,270 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:53:42,271 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:53:42,271 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:53:42,271 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:53:42,272 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:53:42,272 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/01dade48-7948-47ee-9396-2c2b6f442fc7 does not exist. Creating ...
2019-10-02 11:53:42,286 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/01dade48-7948-47ee-9396-2c2b6f442fc7/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:53:42,300 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/01dade48-7948-47ee-9396-2c2b6f442fc7 has been successfully formatted.
2019-10-02 11:53:42,300 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-2C2B6F442FC7: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:53:42,301 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:53:42,301 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:53:42,301 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:53:42,301 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:53:42,301 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:53:42,302 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:53:42,302 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/01dade48-7948-47ee-9396-2c2b6f442fc7
2019-10-02 11:53:42,302 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:53:42,302 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:53:42,302 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:53:42,302 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:53:42,302 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:53:42,303 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:53:42,303 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:53:42,303 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:53:42,303 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:53:42,303 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:53:42,304 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:53:42,304 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:53:42,304 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:53:42,304 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:53:42,304 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:53:42,321 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:53:42,322 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:53:42,322 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:53:42,322 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2C2B6F442FC7,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:53:42,332 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 01dade48-7948-47ee-9396-2c2b6f442fc7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:53:43,078 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-D107A74BAEAB->e5813bca-be1b-4833-8967-802e28d44868@group-331389209C49, cid=1, seq=1*, RW, cmdType: WriteChunk
traceID: "25b79e815b9471d4:25b79e815b9471d4:0:0"
containerID: 1
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 1
    localID: 102892647710195712
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892647710195712_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 54c242b2-5048-45b5-832d-331389209c49, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:53:47,432 [Thread-173] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-FollowerState: change to CANDIDATE, lastRpcTime:5109ms, electionTimeout:5109ms
2019-10-02 11:53:47,434 [Thread-173] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:53:47,434 [Thread-173] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:53:47,435 [Thread-173] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:53:47,450 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:53:47,451 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:53:47,451 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:53:47,452 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5150ms
2019-10-02 11:53:47,452 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:53:47,452 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:53:47,452 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:53:47,453 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:53:47,453 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:53:47,453 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:53:47,458 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:53:47,458 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:53:47,459 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-LeaderElection2] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:53:47,492 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/01dade48-7948-47ee-9396-2c2b6f442fc7/current/log_inprogress_0
2019-10-02 11:53:49,313 [pool-26-thread-2] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:53:49,315 [pool-26-thread-2] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 85d573da1e8c0758:85d573da1e8c0758:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
11:53:49.331 [pool-26-thread-2] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 2 locID: 102892648733278210 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:53:49,332 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #2 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:53:49,333 [pool-26-thread-2] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-2C2B6F442FC7: writeChunk writeStateMachineData failed: blockIdcontainerID: 2
localID: 102892648733278210
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892648733278210_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:53:49,333 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #2
2019-10-02 11:53:49,334 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=01dade48-7948-47ee-9396-2c2b6f442fc7.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:53:49,334 [EventQueue-ContainerReportForContainerReportHandler] WARN  container.ContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #2 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:53:49,335 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 01dade48-7948-47ee-9396-2c2b6f442fc7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:53:49,336 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 01dade48-7948-47ee-9396-2c2b6f442fc7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:53:49,336 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 01dade48-7948-47ee-9396-2c2b6f442fc7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:53:58,202 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-70B451AC32A4->e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7, cid=5, seq=1*, RW, cmdType: WriteChunk
traceID: "85d573da1e8c0758:85d573da1e8c0758:0:0"
containerID: 2
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 2
    localID: 102892648733278210
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892648733278210_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 01dade48-7948-47ee-9396-2c2b6f442fc7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:53:58,232 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-A543FBAF61D8:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-A543FBAF61D8:java.util.concurrent.CompletableFuture@5bd40577[Not completed]
2019-10-02 11:53:58,235 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-A543FBAF61D8:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:53:58,236 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:53:58,236 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:53:58,236 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:53:58,236 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:53:58,237 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:53:58,237 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:53:58,237 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:53:58,238 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:53:58,238 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/2e273e7b-aba5-4c7c-926f-a543fbaf61d8 does not exist. Creating ...
2019-10-02 11:53:58,618 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/2e273e7b-aba5-4c7c-926f-a543fbaf61d8/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:53:58,633 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/2e273e7b-aba5-4c7c-926f-a543fbaf61d8 has been successfully formatted.
2019-10-02 11:53:58,634 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-A543FBAF61D8: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:53:58,634 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:53:58,634 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:53:58,634 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:53:58,635 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:53:58,635 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:53:58,635 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:53:58,635 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/2e273e7b-aba5-4c7c-926f-a543fbaf61d8
2019-10-02 11:53:58,635 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:53:58,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:53:58,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:53:58,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:53:58,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:53:58,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:53:58,637 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:53:58,637 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:53:58,637 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:53:58,638 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:53:58,638 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:53:58,639 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:53:58,639 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:53:58,639 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:53:58,639 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:53:58,645 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:53:58,646 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:53:58,646 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:53:58,647 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A543FBAF61D8,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:53:58,660 [IPC Server handler 0 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 2e273e7b-aba5-4c7c-926f-a543fbaf61d8, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:53:59,346 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:53:59,347 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: shutdown
2019-10-02 11:53:59,347 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2C2B6F442FC7,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:53:59,347 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:53:59,347 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-PendingRequests: sendNotLeaderResponses
2019-10-02 11:53:59,349 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:53:59,351 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7: closes. applyIndex: 0
2019-10-02 11:53:59,352 [e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:53:59,353 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C2B6F442FC7-SegmentedRaftLogWorker close()
2019-10-02 11:53:59,363 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 01dade48-7948-47ee-9396-2c2b6f442fc7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:54:03,697 [Thread-191] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-FollowerState: change to CANDIDATE, lastRpcTime:5050ms, electionTimeout:5050ms
2019-10-02 11:54:03,698 [Thread-191] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:54:03,698 [Thread-191] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:54:03,699 [Thread-191] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:54:03,729 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:03,729 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:54:03,729 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:54:03,730 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5095ms
2019-10-02 11:54:03,730 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:54:03,730 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:54:03,730 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:54:03,730 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:54:03,731 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:54:03,731 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:54:03,735 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:54:03,735 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:54:03,736 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-LeaderElection3] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:54:03,783 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/2e273e7b-aba5-4c7c-926f-a543fbaf61d8/current/log_inprogress_0
2019-10-02 11:54:05,559 [pool-26-thread-3] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:05,560 [pool-26-thread-3] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 6c1f0c01aa584f18:6c1f0c01aa584f18:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:54:05,572 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #3 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
11:54:05.571 [pool-26-thread-3] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 3 locID: 102892649752887299 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:54:05,573 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #3
2019-10-02 11:54:05,573 [pool-26-thread-3] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-A543FBAF61D8: writeChunk writeStateMachineData failed: blockIdcontainerID: 3
localID: 102892649752887299
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892649752887299_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:54:05,573 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=2e273e7b-aba5-4c7c-926f-a543fbaf61d8.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:05,575 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 2e273e7b-aba5-4c7c-926f-a543fbaf61d8, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:05,575 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 2e273e7b-aba5-4c7c-926f-a543fbaf61d8, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:54:05,575 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 2e273e7b-aba5-4c7c-926f-a543fbaf61d8, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:54:14,469 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-33C3BCC8E3B6->e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8, cid=9, seq=1*, RW, cmdType: WriteChunk
traceID: "6c1f0c01aa584f18:6c1f0c01aa584f18:0:0"
containerID: 3
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 3
    localID: 102892649752887299
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892649752887299_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 2e273e7b-aba5-4c7c-926f-a543fbaf61d8, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:54:14,501 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-E3FC681B7FD0:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-E3FC681B7FD0:java.util.concurrent.CompletableFuture@3dfb6e33[Not completed]
2019-10-02 11:54:14,503 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-E3FC681B7FD0:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:54:14,504 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:54:14,504 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:54:14,504 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:54:14,504 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:54:14,504 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:54:14,504 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:54:14,505 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:54:14,505 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:54:14,505 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/e67631a6-c9d7-4d9c-90e6-e3fc681b7fd0 does not exist. Creating ...
2019-10-02 11:54:15,589 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:54:15,590 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: shutdown
2019-10-02 11:54:15,590 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A543FBAF61D8,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:15,591 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:54:15,591 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-PendingRequests: sendNotLeaderResponses
2019-10-02 11:54:15,593 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:54:15,595 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8: closes. applyIndex: 0
2019-10-02 11:54:15,598 [e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:54:15,599 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-A543FBAF61D8-SegmentedRaftLogWorker close()
2019-10-02 11:54:17,502 [RATISCREATEPIPELINE0] ERROR pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$null$5(235)) - Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@72d7bee4 for e5813bca-be1b-4833-8967-802e28d44868
org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999521615ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999521615ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 11:54:17,508 [IPC Server handler 0 on 33744] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(192)) - Pipeline creation failed for type:RATIS factor:ONE. Retrying get pipelines call once.
java.io.IOException: Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@72d7bee4 for e5813bca-be1b-4833-8967-802e28d44868
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:236)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999521615ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	... 19 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999521615ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 11:54:17,508 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 2e273e7b-aba5-4c7c-926f-a543fbaf61d8, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:54:17,510 [IPC Server handler 0 on 33744] INFO  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(198)) - Could not find available pipeline of type:RATIS and factor:ONE even after retrying
2019-10-02 11:54:17,510 [IPC Server handler 0 on 33744] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(222)) - Unable to allocate a block for the size: 4194304, type: RATIS, factor: ONE
2019-10-02 11:54:17,518 [main] ERROR io.BlockOutputStreamEntryPool (BlockOutputStreamEntryPool.java:allocateBlockIfNeeded(299)) - Try to allocate more blocks for write failed, already allocated 0 blocks for this write.
INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocated 0 blocks. Requested 1 blocks
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:732)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.allocateBlock(OzoneManagerProtocolClientSideTranslatorPB.java:764)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66)
	at com.sun.proxy.$Proxy37.allocateBlock(Unknown Source)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateNewBlock(BlockOutputStreamEntryPool.java:248)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateBlockIfNeeded(BlockOutputStreamEntryPool.java:296)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:198)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleRetry(KeyOutputStream.java:375)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleException(KeyOutputStream.java:324)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleFlushOrClose(KeyOutputStream.java:449)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.flush(KeyOutputStream.java:397)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.flush(OzoneOutputStream.java:54)
	at org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures.testValidateBCSIDOnDnRestart(TestContainerStateMachineFailures.java:429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-10-02 11:54:17,520 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-A83C9BEF6A29:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-A83C9BEF6A29:java.util.concurrent.CompletableFuture@2e8a75f3[Not completed]
]]></system-out>
    <system-err><![CDATA[ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
]]></system-err>
  </testcase>
  <testcase name="testApplyTransactionIdempotencyWithClosedContainer" classname="org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures" time="6.011">
    <error message="Allocated 0 blocks. Requested 1 blocks" type="INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException">INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocated 0 blocks. Requested 1 blocks
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:732)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.openKey(OzoneManagerProtocolClientSideTranslatorPB.java:723)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66)
	at com.sun.proxy.$Proxy37.openKey(Unknown Source)
	at org.apache.hadoop.ozone.client.rpc.RpcClient.createKey(RpcClient.java:614)
	at org.apache.hadoop.ozone.client.OzoneBucket.createKey(OzoneBucket.java:325)
	at org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures.testApplyTransactionIdempotencyWithClosedContainer(TestContainerStateMachineFailures.java:361)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
</error>
    <system-out><![CDATA[2019-10-02 11:54:20,521 [RATISCREATEPIPELINE0] ERROR pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$null$5(235)) - Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@11f4bf3a for e5813bca-be1b-4833-8967-802e28d44868
org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999695231ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999695231ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 11:54:20,544 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-617F72E4DD3D:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-617F72E4DD3D:java.util.concurrent.CompletableFuture@4401426f[Not completed]
2019-10-02 11:54:23,534 [RATISCREATEPIPELINE0] ERROR pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$null$5(235)) - Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@3b2e4ab4 for e5813bca-be1b-4833-8967-802e28d44868
org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999595139ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999595139ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 11:54:23,536 [IPC Server handler 6 on 33744] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(192)) - Pipeline creation failed for type:RATIS factor:ONE. Retrying get pipelines call once.
java.io.IOException: Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@3b2e4ab4 for e5813bca-be1b-4833-8967-802e28d44868
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:236)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999595139ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	... 19 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999595139ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 11:54:23,538 [IPC Server handler 6 on 33744] INFO  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(198)) - Could not find available pipeline of type:RATIS and factor:ONE even after retrying
2019-10-02 11:54:23,538 [IPC Server handler 6 on 33744] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(222)) - Unable to allocate a block for the size: 4194304, type: RATIS, factor: ONE
]]></system-out>
  </testcase>
  <testcase name="testContainerStateMachineFailures" classname="org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures" time="399.35">
    <error message="Allocated 0 blocks. Requested 1 blocks" type="INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException">INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocated 0 blocks. Requested 1 blocks
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:732)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.allocateBlock(OzoneManagerProtocolClientSideTranslatorPB.java:764)
	at sun.reflect.GeneratedMethodAccessor179.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66)
	at com.sun.proxy.$Proxy37.allocateBlock(Unknown Source)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateNewBlock(BlockOutputStreamEntryPool.java:248)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateBlockIfNeeded(BlockOutputStreamEntryPool.java:296)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:198)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleRetry(KeyOutputStream.java:375)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleException(KeyOutputStream.java:324)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleFlushOrClose(KeyOutputStream.java:449)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.flush(KeyOutputStream.java:397)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.flush(OzoneOutputStream.java:54)
	at org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures.testContainerStateMachineFailures(TestContainerStateMachineFailures.java:158)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
</error>
    <system-out><![CDATA[2019-10-02 11:54:23,563 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-49BC322AA314:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-49BC322AA314:java.util.concurrent.CompletableFuture@6fb77fc8[Not completed]
2019-10-02 11:54:24,860 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/e67631a6-c9d7-4d9c-90e6-e3fc681b7fd0/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:54:24,887 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/e67631a6-c9d7-4d9c-90e6-e3fc681b7fd0 has been successfully formatted.
2019-10-02 11:54:24,888 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-E3FC681B7FD0: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:54:24,888 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:54:24,889 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:54:24,889 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:54:24,889 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:54:24,889 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:24,890 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:54:24,890 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/e67631a6-c9d7-4d9c-90e6-e3fc681b7fd0
2019-10-02 11:54:24,890 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:54:24,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:54:24,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:24,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:54:24,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:54:24,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:54:24,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:54:24,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:54:24,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:54:24,893 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:54:24,893 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:54:24,894 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:54:24,894 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:54:24,894 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:54:24,895 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:54:24,902 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-A83C9BEF6A29:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:54:24,902 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:54:24,902 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:54:24,903 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:54:24,903 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:54:24,903 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:54:24,903 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:54:24,903 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:54:24,904 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:54:24,904 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f6e4d00f-d9f4-4a9a-a965-a83c9bef6a29 does not exist. Creating ...
2019-10-02 11:54:24,918 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f6e4d00f-d9f4-4a9a-a965-a83c9bef6a29/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:54:24,932 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f6e4d00f-d9f4-4a9a-a965-a83c9bef6a29 has been successfully formatted.
2019-10-02 11:54:24,933 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-A83C9BEF6A29: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:54:24,933 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:54:24,933 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:54:24,934 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:54:24,934 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:54:24,934 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:24,934 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:54:24,934 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f6e4d00f-d9f4-4a9a-a965-a83c9bef6a29
2019-10-02 11:54:24,935 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:54:24,935 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:54:24,935 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:24,935 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:54:24,935 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:54:24,936 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:54:24,936 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:54:24,936 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:54:24,936 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:54:24,937 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:54:24,937 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:54:24,937 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:54:24,938 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:54:24,938 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:54:24,938 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:54:24,943 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-617F72E4DD3D:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:54:24,943 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:54:24,943 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:54:24,943 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:54:24,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:54:24,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:54:24,944 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:54:24,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:54:24,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:54:24,945 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/61233d4e-dd08-4738-a25b-617f72e4dd3d does not exist. Creating ...
2019-10-02 11:54:24,958 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/61233d4e-dd08-4738-a25b-617f72e4dd3d/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:54:24,971 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/61233d4e-dd08-4738-a25b-617f72e4dd3d has been successfully formatted.
2019-10-02 11:54:24,971 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-617F72E4DD3D: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:54:24,971 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:54:24,972 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:54:24,972 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:54:24,972 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:54:24,972 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:24,973 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:54:24,973 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/61233d4e-dd08-4738-a25b-617f72e4dd3d
2019-10-02 11:54:24,973 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:54:24,973 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:54:24,973 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:24,974 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:54:24,974 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:54:24,974 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:54:24,974 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:54:24,974 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:54:24,974 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:54:24,975 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:54:24,975 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:54:24,975 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:54:24,975 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:54:24,976 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:54:24,976 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:54:24,980 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-49BC322AA314:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:54:24,980 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:54:24,980 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:54:24,980 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:54:24,981 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:54:24,981 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:54:24,981 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:54:24,981 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:54:24,981 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:54:24,982 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/1098b24e-01ba-476c-a5e0-49bc322aa314 does not exist. Creating ...
2019-10-02 11:54:24,994 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/1098b24e-01ba-476c-a5e0-49bc322aa314/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:54:25,007 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/1098b24e-01ba-476c-a5e0-49bc322aa314 has been successfully formatted.
2019-10-02 11:54:25,007 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-49BC322AA314: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:54:25,007 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:54:25,007 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:54:25,007 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:54:25,008 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:54:25,008 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:25,008 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:54:25,008 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/1098b24e-01ba-476c-a5e0-49bc322aa314
2019-10-02 11:54:25,008 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:54:25,008 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:54:25,008 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:25,009 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:54:25,009 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:54:25,009 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:54:25,009 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:54:25,009 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:54:25,009 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:54:25,009 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:54:25,010 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:54:25,010 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:54:25,010 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:54:25,010 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:54:25,010 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:54:25,013 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:25,013 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:54:25,013 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:54:25,014 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E3FC681B7FD0,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:25,016 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:25,016 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:54:25,016 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:54:25,018 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A83C9BEF6A29,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:25,020 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:25,020 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:54:25,020 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:54:25,021 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-617F72E4DD3D,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:25,023 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:25,023 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:54:25,023 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:54:25,024 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-49BC322AA314,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:25,032 [IPC Server handler 7 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 1098b24e-01ba-476c-a5e0-49bc322aa314, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:54:30,096 [Thread-218] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-FollowerState: change to CANDIDATE, lastRpcTime:5079ms, electionTimeout:5078ms
2019-10-02 11:54:30,097 [Thread-218] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:54:30,097 [Thread-218] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:54:30,097 [Thread-218] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:54:30,112 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:30,113 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:54:30,113 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:54:30,113 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5179ms
2019-10-02 11:54:30,113 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:54:30,113 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:54:30,114 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:54:30,114 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:54:30,114 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:54:30,114 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:54:30,117 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:54:30,118 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:54:30,118 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-LeaderElection4] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:54:30,144 [Thread-220] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-FollowerState: change to CANDIDATE, lastRpcTime:5123ms, electionTimeout:5121ms
2019-10-02 11:54:30,144 [Thread-220] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:54:30,144 [Thread-220] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:54:30,145 [Thread-220] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:54:30,157 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f6e4d00f-d9f4-4a9a-a965-a83c9bef6a29/current/log_inprogress_0
2019-10-02 11:54:30,157 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:30,157 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:54:30,157 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:54:30,158 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5186ms
2019-10-02 11:54:30,158 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:54:30,158 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:54:30,158 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:54:30,158 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:54:30,158 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:54:30,158 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:54:30,160 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:54:30,160 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:54:30,161 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-LeaderElection5] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:54:30,185 [Thread-222] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-FollowerState: change to CANDIDATE, lastRpcTime:5161ms, electionTimeout:5154ms
2019-10-02 11:54:30,185 [Thread-222] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:54:30,185 [Thread-222] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:54:30,185 [Thread-222] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:54:30,199 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/61233d4e-dd08-4738-a25b-617f72e4dd3d/current/log_inprogress_0
2019-10-02 11:54:30,199 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:30,199 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:54:30,199 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:54:30,200 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5192ms
2019-10-02 11:54:30,200 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:54:30,200 [Thread-216] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-FollowerState: change to CANDIDATE, lastRpcTime:5186ms, electionTimeout:5186ms
2019-10-02 11:54:30,200 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:54:30,200 [Thread-216] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:54:30,200 [Thread-216] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:54:30,200 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:54:30,200 [Thread-216] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:54:30,201 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:54:30,201 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:54:30,202 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:54:30,205 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:54:30,206 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:54:30,206 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-LeaderElection6] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:54:30,240 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:30,240 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:54:30,240 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:54:30,240 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5352ms
2019-10-02 11:54:30,241 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:54:30,241 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:54:30,241 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:54:30,241 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:54:30,241 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:54:30,241 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:54:30,243 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:54:30,243 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:54:30,244 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-LeaderElection7] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:54:30,276 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/1098b24e-01ba-476c-a5e0-49bc322aa314/current/log_inprogress_0
2019-10-02 11:54:30,288 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/e67631a6-c9d7-4d9c-90e6-e3fc681b7fd0/current/log_inprogress_0
2019-10-02 11:54:31,210 [pool-26-thread-4] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:31,211 [pool-26-thread-4] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 261ea80275eb0559:261ea80275eb0559:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
11:54:31.227 [pool-26-thread-4] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 4 locID: 102892651481137156 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:54:31,228 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #4 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:54:31,228 [pool-26-thread-4] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-49BC322AA314: writeChunk writeStateMachineData failed: blockIdcontainerID: 4
localID: 102892651481137156
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892651481137156_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:54:31,228 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #4
2019-10-02 11:54:31,228 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=1098b24e-01ba-476c-a5e0-49bc322aa314.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:31,229 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 1098b24e-01ba-476c-a5e0-49bc322aa314, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:31,230 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 1098b24e-01ba-476c-a5e0-49bc322aa314, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:54:31,230 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 1098b24e-01ba-476c-a5e0-49bc322aa314, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:54:40,141 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-91D15E5ECB6E->e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314, cid=16, seq=1*, RW, cmdType: WriteChunk
traceID: "261ea80275eb0559:261ea80275eb0559:0:0"
containerID: 4
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 4
    localID: 102892651481137156
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892651481137156_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 1098b24e-01ba-476c-a5e0-49bc322aa314, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:54:40,177 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-87A4FFD51583:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-87A4FFD51583:java.util.concurrent.CompletableFuture@4ae901bc[Not completed]
2019-10-02 11:54:40,180 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-87A4FFD51583:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:54:40,181 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:54:40,181 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:54:40,181 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:54:40,182 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:54:40,182 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:54:40,182 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:54:40,182 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:54:40,183 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:54:40,183 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/24596d4b-6640-490b-8905-87a4ffd51583 does not exist. Creating ...
2019-10-02 11:54:40,196 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/24596d4b-6640-490b-8905-87a4ffd51583/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:54:40,209 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/24596d4b-6640-490b-8905-87a4ffd51583 has been successfully formatted.
2019-10-02 11:54:40,209 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-87A4FFD51583: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:54:40,209 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:54:40,210 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:54:40,210 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:54:40,210 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:54:40,210 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:40,210 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:54:40,211 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/24596d4b-6640-490b-8905-87a4ffd51583
2019-10-02 11:54:40,211 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:54:40,211 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:54:40,211 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:40,211 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:54:40,212 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:54:40,212 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:54:40,212 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:54:40,212 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:54:40,212 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:54:40,213 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:54:40,213 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:54:40,214 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:54:40,214 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:54:40,214 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:54:40,214 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:54:40,218 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:40,218 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:54:40,218 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:54:40,219 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-87A4FFD51583,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:40,229 [IPC Server handler 11 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 24596d4b-6640-490b-8905-87a4ffd51583, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:54:41,242 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:54:41,243 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: shutdown
2019-10-02 11:54:41,243 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-49BC322AA314,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:41,243 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:54:41,244 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-PendingRequests: sendNotLeaderResponses
2019-10-02 11:54:41,247 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:54:41,249 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314: closes. applyIndex: 0
2019-10-02 11:54:41,254 [e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:54:41,255 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-49BC322AA314-SegmentedRaftLogWorker close()
2019-10-02 11:54:41,268 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 1098b24e-01ba-476c-a5e0-49bc322aa314, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:54:45,246 [Thread-244] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-FollowerState: change to CANDIDATE, lastRpcTime:5027ms, electionTimeout:5027ms
2019-10-02 11:54:45,247 [Thread-244] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:54:45,247 [Thread-244] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:54:45,247 [Thread-244] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:54:45,263 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:45,263 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:54:45,263 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:54:45,263 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5053ms
2019-10-02 11:54:45,264 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:54:45,264 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:54:45,264 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:54:45,264 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:54:45,265 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:54:45,265 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:54:45,269 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:54:45,269 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:54:45,270 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-LeaderElection8] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:54:45,330 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/24596d4b-6640-490b-8905-87a4ffd51583/current/log_inprogress_0
2019-10-02 11:54:47,458 [pool-26-thread-5] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:47,459 [pool-26-thread-5] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 3e70cd82217172b7:3e70cd82217172b7:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:54:47,474 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #5 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
11:54:47.473 [pool-26-thread-5] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 5 locID: 102892652477153286 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:54:47,474 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #5
2019-10-02 11:54:47,474 [pool-26-thread-5] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-87A4FFD51583: writeChunk writeStateMachineData failed: blockIdcontainerID: 5
localID: 102892652477153286
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892652477153286_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:54:47,475 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=24596d4b-6640-490b-8905-87a4ffd51583.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:47,475 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 24596d4b-6640-490b-8905-87a4ffd51583, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:54:47,475 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 24596d4b-6640-490b-8905-87a4ffd51583, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:54:47,476 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 24596d4b-6640-490b-8905-87a4ffd51583, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:54:56,378 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-9D5CC01E4F6F->e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583, cid=20, seq=1*, RW, cmdType: WriteChunk
traceID: "3e70cd82217172b7:3e70cd82217172b7:0:0"
containerID: 5
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 5
    localID: 102892652477153286
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892652477153286_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 24596d4b-6640-490b-8905-87a4ffd51583, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:54:56,416 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-82B58624BC12:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-82B58624BC12:java.util.concurrent.CompletableFuture@155b2a94[Not completed]
2019-10-02 11:54:56,420 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-82B58624BC12:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:54:56,421 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:54:56,421 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:54:56,422 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:54:56,422 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:54:56,422 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:54:56,422 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:54:56,422 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:54:56,423 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:54:56,423 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/36704ebf-9325-43d4-bc7e-82b58624bc12 does not exist. Creating ...
2019-10-02 11:54:56,448 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/36704ebf-9325-43d4-bc7e-82b58624bc12/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:54:56,463 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/36704ebf-9325-43d4-bc7e-82b58624bc12 has been successfully formatted.
2019-10-02 11:54:56,463 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-82B58624BC12: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:54:56,463 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:54:56,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:54:56,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:54:56,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:54:56,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:56,465 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:54:56,465 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/36704ebf-9325-43d4-bc7e-82b58624bc12
2019-10-02 11:54:56,465 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:54:56,465 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:54:56,465 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:54:56,466 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:54:56,466 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:54:56,466 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:54:56,466 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:54:56,466 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:54:56,467 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:54:56,467 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:54:56,467 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:54:56,468 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:54:56,468 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:54:56,468 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:54:56,469 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:54:56,473 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:54:56,473 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:54:56,473 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:54:56,474 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-82B58624BC12,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:56,488 [IPC Server handler 0 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 36704ebf-9325-43d4-bc7e-82b58624bc12, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:54:57,486 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:54:57,487 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: shutdown
2019-10-02 11:54:57,487 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-87A4FFD51583,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:54:57,487 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:54:57,488 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-PendingRequests: sendNotLeaderResponses
2019-10-02 11:54:57,490 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:54:57,493 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583: closes. applyIndex: 0
2019-10-02 11:54:57,493 [e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:54:57,494 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-87A4FFD51583-SegmentedRaftLogWorker close()
2019-10-02 11:54:57,507 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 24596d4b-6640-490b-8905-87a4ffd51583, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:55:01,545 [Thread-262] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-FollowerState: change to CANDIDATE, lastRpcTime:5071ms, electionTimeout:5071ms
2019-10-02 11:55:01,545 [Thread-262] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:55:01,545 [Thread-262] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:55:01,545 [Thread-262] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:55:01,562 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:01,562 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:55:01,562 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:55:01,562 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5098ms
2019-10-02 11:55:01,562 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:55:01,563 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:55:01,563 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:55:01,563 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:55:01,563 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:55:01,563 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:55:01,565 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:55:01,566 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:55:01,566 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-LeaderElection9] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:55:01,608 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/36704ebf-9325-43d4-bc7e-82b58624bc12/current/log_inprogress_0
2019-10-02 11:55:03,670 [pool-26-thread-6] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:03,671 [pool-26-thread-6] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 7edbb97c12c7d38c:7edbb97c12c7d38c:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:55:03,687 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #6 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:55:03,687 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #6
11:55:03.686 [pool-26-thread-6] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 6 locID: 102892653542637575 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:55:03,688 [pool-26-thread-6] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-82B58624BC12: writeChunk writeStateMachineData failed: blockIdcontainerID: 6
localID: 102892653542637575
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892653542637575_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:55:03,688 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=36704ebf-9325-43d4-bc7e-82b58624bc12.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:03,689 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 36704ebf-9325-43d4-bc7e-82b58624bc12, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:03,689 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 36704ebf-9325-43d4-bc7e-82b58624bc12, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:03,689 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 36704ebf-9325-43d4-bc7e-82b58624bc12, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:55:06,308 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:55:06,310 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: shutdown
2019-10-02 11:55:06,311 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-617F72E4DD3D,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:06,311 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:55:06,311 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-PendingRequests: sendNotLeaderResponses
2019-10-02 11:55:06,311 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:55:06,313 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D: closes. applyIndex: 0
2019-10-02 11:55:06,313 [e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:55:06,314 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-617F72E4DD3D-SegmentedRaftLogWorker close()
2019-10-02 11:55:06,337 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:55:06,337 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: shutdown
2019-10-02 11:55:06,337 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E3FC681B7FD0,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:06,337 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:55:06,338 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-PendingRequests: sendNotLeaderResponses
2019-10-02 11:55:06,338 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:55:06,339 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0: closes. applyIndex: 0
2019-10-02 11:55:06,339 [e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:55:06,340 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-E3FC681B7FD0-SegmentedRaftLogWorker close()
2019-10-02 11:55:06,355 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:55:06,355 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: shutdown
2019-10-02 11:55:06,355 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A83C9BEF6A29,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:06,356 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:55:06,356 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-PendingRequests: sendNotLeaderResponses
2019-10-02 11:55:06,356 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:55:06,357 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29: closes. applyIndex: 0
2019-10-02 11:55:06,357 [e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:55:06,358 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-A83C9BEF6A29-SegmentedRaftLogWorker close()
2019-10-02 11:55:12,600 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-7404864E88E5->e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12, cid=24, seq=1*, RW, cmdType: WriteChunk
traceID: "7edbb97c12c7d38c:7edbb97c12c7d38c:0:0"
containerID: 6
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 6
    localID: 102892653542637575
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892653542637575_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 36704ebf-9325-43d4-bc7e-82b58624bc12, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:55:12,632 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-FF50D540C39C:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-FF50D540C39C:java.util.concurrent.CompletableFuture@224842ff[Not completed]
2019-10-02 11:55:12,634 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-FF50D540C39C:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:55:12,635 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:55:12,635 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:55:12,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:55:12,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:55:12,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:55:12,636 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:55:12,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:55:12,637 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:55:12,637 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/806b9266-1083-4d2e-87d2-ff50d540c39c does not exist. Creating ...
2019-10-02 11:55:12,678 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/806b9266-1083-4d2e-87d2-ff50d540c39c/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:55:12,689 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/806b9266-1083-4d2e-87d2-ff50d540c39c has been successfully formatted.
2019-10-02 11:55:12,690 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-FF50D540C39C: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:55:12,690 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:55:12,690 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:55:12,690 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:55:12,691 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:55:12,691 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:12,691 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:55:12,691 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/806b9266-1083-4d2e-87d2-ff50d540c39c
2019-10-02 11:55:12,691 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:55:12,691 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:55:12,692 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:12,692 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:55:12,692 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:55:12,692 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:55:12,692 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:55:12,692 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:55:12,693 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:55:12,693 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:55:12,693 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:55:12,693 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:55:12,693 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:55:12,693 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:55:12,694 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:55:12,696 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:12,696 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:55:12,696 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:55:12,697 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FF50D540C39C,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:12,711 [IPC Server handler 7 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 806b9266-1083-4d2e-87d2-ff50d540c39c, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:13,698 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:55:13,698 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: shutdown
2019-10-02 11:55:13,698 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-82B58624BC12,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:13,698 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:55:13,699 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-PendingRequests: sendNotLeaderResponses
2019-10-02 11:55:13,701 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:55:13,703 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12: closes. applyIndex: 0
2019-10-02 11:55:13,704 [e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:55:13,705 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-82B58624BC12-SegmentedRaftLogWorker close()
2019-10-02 11:55:13,714 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 36704ebf-9325-43d4-bc7e-82b58624bc12, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:55:17,829 [Thread-283] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-FollowerState: change to CANDIDATE, lastRpcTime:5132ms, electionTimeout:5132ms
2019-10-02 11:55:17,830 [Thread-283] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:55:17,830 [Thread-283] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:55:17,830 [Thread-283] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:55:17,841 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:17,841 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:55:17,841 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:55:17,842 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5151ms
2019-10-02 11:55:17,842 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:55:17,842 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:55:17,842 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:55:17,842 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:55:17,843 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:55:17,843 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:55:17,847 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:55:17,847 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:55:17,848 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-LeaderElection10] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:55:17,886 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/806b9266-1083-4d2e-87d2-ff50d540c39c/current/log_inprogress_0
2019-10-02 11:55:19,860 [pool-26-thread-7] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:19,861 [pool-26-thread-7] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 1422d09b26445ae7:1422d09b26445ae7:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
11:55:19.875 [pool-26-thread-7] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 7 locID: 102892654605893640 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:55:19,876 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #7 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:55:19,876 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #7
2019-10-02 11:55:19,876 [pool-26-thread-7] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-FF50D540C39C: writeChunk writeStateMachineData failed: blockIdcontainerID: 7
localID: 102892654605893640
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892654605893640_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:55:19,877 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=806b9266-1083-4d2e-87d2-ff50d540c39c.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:19,877 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 806b9266-1083-4d2e-87d2-ff50d540c39c, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:19,878 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 806b9266-1083-4d2e-87d2-ff50d540c39c, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:19,878 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 806b9266-1083-4d2e-87d2-ff50d540c39c, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:55:26,695 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-7DAE36E64455:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-7DAE36E64455:java.util.concurrent.CompletableFuture@a06514f[Not completed]
2019-10-02 11:55:26,698 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-7DAE36E64455:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:55:26,698 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:55:26,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:55:26,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:55:26,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:55:26,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:55:26,699 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:55:26,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:55:26,700 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:55:26,700 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/749d0dfc-7de4-4c68-a54d-7dae36e64455 does not exist. Creating ...
2019-10-02 11:55:26,714 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/749d0dfc-7de4-4c68-a54d-7dae36e64455/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:55:26,728 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/749d0dfc-7de4-4c68-a54d-7dae36e64455 has been successfully formatted.
2019-10-02 11:55:26,728 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-7DAE36E64455: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:55:26,728 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:55:26,728 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:55:26,728 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:55:26,729 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:55:26,729 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:26,729 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:55:26,729 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/749d0dfc-7de4-4c68-a54d-7dae36e64455
2019-10-02 11:55:26,729 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:55:26,729 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:55:26,730 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:26,730 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:55:26,730 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:55:26,730 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:55:26,730 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:55:26,730 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:55:26,730 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:55:26,731 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:55:26,731 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:55:26,731 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:55:26,731 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:55:26,732 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:55:26,732 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:55:26,735 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:26,735 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:55:26,735 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:55:26,735 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7DAE36E64455,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:26,743 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 749d0dfc-7de4-4c68-a54d-7dae36e64455, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:28,801 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-91A9B32C85F4->e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C, cid=31, seq=1*, RW, cmdType: WriteChunk
traceID: "1422d09b26445ae7:1422d09b26445ae7:0:0"
containerID: 7
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 7
    localID: 102892654605893640
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892654605893640_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 806b9266-1083-4d2e-87d2-ff50d540c39c, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:55:29,888 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:55:29,888 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: shutdown
2019-10-02 11:55:29,888 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FF50D540C39C,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:29,889 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:55:29,889 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-PendingRequests: sendNotLeaderResponses
2019-10-02 11:55:29,892 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:55:29,895 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C: closes. applyIndex: 0
2019-10-02 11:55:29,897 [e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:55:29,900 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-FF50D540C39C-SegmentedRaftLogWorker close()
2019-10-02 11:55:29,920 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 806b9266-1083-4d2e-87d2-ff50d540c39c, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:55:31,823 [Thread-300] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-FollowerState: change to CANDIDATE, lastRpcTime:5088ms, electionTimeout:5088ms
2019-10-02 11:55:31,824 [Thread-300] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:55:31,824 [Thread-300] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:55:31,824 [Thread-300] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:55:31,851 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:31,852 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:55:31,852 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:55:31,852 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5124ms
2019-10-02 11:55:31,852 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:55:31,853 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:55:31,853 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:55:31,853 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:55:31,854 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:55:31,854 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:55:31,858 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:55:31,859 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:55:31,860 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-LeaderElection11] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:55:31,908 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/749d0dfc-7de4-4c68-a54d-7dae36e64455/current/log_inprogress_0
2019-10-02 11:55:32,032 [pool-26-thread-8] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:32,032 [pool-26-thread-8] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: a235c877c731e5c0:a235c877c731e5c0:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
11:55:32.046 [pool-26-thread-8] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 8 locID: 102892655661481993 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:55:32,046 [pool-26-thread-8] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-7DAE36E64455: writeChunk writeStateMachineData failed: blockIdcontainerID: 8
localID: 102892655661481993
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892655661481993_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:55:32,047 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=749d0dfc-7de4-4c68-a54d-7dae36e64455.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:32,047 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #8 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:55:32,047 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #8
2019-10-02 11:55:32,048 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 749d0dfc-7de4-4c68-a54d-7dae36e64455, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:32,048 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 749d0dfc-7de4-4c68-a54d-7dae36e64455, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:32,048 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 749d0dfc-7de4-4c68-a54d-7dae36e64455, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:55:42,055 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:55:42,056 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: shutdown
2019-10-02 11:55:42,056 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7DAE36E64455,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:42,056 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:55:42,057 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-PendingRequests: sendNotLeaderResponses
2019-10-02 11:55:42,058 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:55:42,059 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455: closes. applyIndex: 0
2019-10-02 11:55:42,061 [e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:55:42,062 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-7DAE36E64455-SegmentedRaftLogWorker close()
2019-10-02 11:55:42,066 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 749d0dfc-7de4-4c68-a54d-7dae36e64455, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:55:42,071 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-BD35F0CD1E5E:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-BD35F0CD1E5E:java.util.concurrent.CompletableFuture@53b4ff29[Not completed]
2019-10-02 11:55:42,073 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-BD35F0CD1E5E:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:55:42,073 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:55:42,074 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:55:42,074 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:55:42,074 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:55:42,074 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:55:42,074 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:55:42,074 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:55:42,074 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:55:42,075 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/00b18887-f307-4103-8dd2-bd35f0cd1e5e does not exist. Creating ...
2019-10-02 11:55:42,090 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/00b18887-f307-4103-8dd2-bd35f0cd1e5e/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:55:42,103 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/00b18887-f307-4103-8dd2-bd35f0cd1e5e has been successfully formatted.
2019-10-02 11:55:42,103 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-BD35F0CD1E5E: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:55:42,103 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/00b18887-f307-4103-8dd2-bd35f0cd1e5e
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:55:42,104 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:55:42,105 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:55:42,106 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:55:42,106 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:55:42,106 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:55:42,106 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:55:42,108 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:42,108 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:55:42,108 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:55:42,108 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BD35F0CD1E5E,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:42,112 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 00b18887-f307-4103-8dd2-bd35f0cd1e5e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:44,005 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.GroupMismatchException: e5813bca-be1b-4833-8967-802e28d44868: group-7DAE36E64455 not found. on the pipeline Pipeline[ Id: 749d0dfc-7de4-4c68-a54d-7dae36e64455, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:55:47,194 [Thread-316] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-FollowerState: change to CANDIDATE, lastRpcTime:5086ms, electionTimeout:5086ms
2019-10-02 11:55:47,195 [Thread-316] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:55:47,195 [Thread-316] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:55:47,195 [Thread-316] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:55:47,223 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:47,224 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:55:47,224 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:55:47,224 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5120ms
2019-10-02 11:55:47,224 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:55:47,224 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:55:47,225 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:55:47,225 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:55:47,225 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:55:47,225 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:55:47,233 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:55:47,234 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:55:47,239 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-LeaderElection12] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:55:47,270 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/00b18887-f307-4103-8dd2-bd35f0cd1e5e/current/log_inprogress_0
2019-10-02 11:55:48,186 [pool-26-thread-9] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:48,186 [pool-26-thread-9] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 954eb62fdc97f95e:954eb62fdc97f95e:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:55:48,201 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #9 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
11:55:48.201 [pool-26-thread-9] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 9 locID: 102892656657694730 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:55:48,203 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #9
2019-10-02 11:55:48,203 [pool-26-thread-9] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-BD35F0CD1E5E: writeChunk writeStateMachineData failed: blockIdcontainerID: 9
localID: 102892656657694730
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892656657694730_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:55:48,203 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=00b18887-f307-4103-8dd2-bd35f0cd1e5e.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:48,207 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 00b18887-f307-4103-8dd2-bd35f0cd1e5e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:55:48,207 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 00b18887-f307-4103-8dd2-bd35f0cd1e5e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:48,207 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 00b18887-f307-4103-8dd2-bd35f0cd1e5e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:55:58,217 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:55:58,219 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: shutdown
2019-10-02 11:55:58,219 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BD35F0CD1E5E,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:58,219 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:55:58,219 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-PendingRequests: sendNotLeaderResponses
2019-10-02 11:55:58,222 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:55:58,227 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E: closes. applyIndex: 0
2019-10-02 11:55:58,228 [e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:55:58,230 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E-SegmentedRaftLogWorker close()
2019-10-02 11:55:58,238 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 00b18887-f307-4103-8dd2-bd35f0cd1e5e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:55:58,252 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-E4208F826476:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-E4208F826476:java.util.concurrent.CompletableFuture@183a2eb3[Not completed]
2019-10-02 11:55:58,254 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-E4208F826476:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:55:58,254 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:55:58,254 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:55:58,254 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:55:58,255 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:55:58,255 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:55:58,255 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:55:58,255 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:55:58,255 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:55:58,256 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f2eefe8a-b435-4874-97c6-e4208f826476 does not exist. Creating ...
2019-10-02 11:55:58,270 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f2eefe8a-b435-4874-97c6-e4208f826476/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:55:58,283 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f2eefe8a-b435-4874-97c6-e4208f826476 has been successfully formatted.
2019-10-02 11:55:58,283 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-E4208F826476: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:55:58,283 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:55:58,283 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:55:58,283 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:55:58,283 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:55:58,284 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:58,284 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:55:58,284 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f2eefe8a-b435-4874-97c6-e4208f826476
2019-10-02 11:55:58,284 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:55:58,284 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:55:58,284 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:55:58,284 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:55:58,285 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:55:58,285 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:55:58,285 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:55:58,285 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:55:58,285 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:55:58,285 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:55:58,286 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:55:58,286 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:55:58,286 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:55:58,286 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:55:58,286 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:55:58,291 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:55:58,291 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:55:58,292 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:55:58,292 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E4208F826476,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:55:58,302 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f2eefe8a-b435-4874-97c6-e4208f826476, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:55:59,116 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-6BA88EC3E5E8->e5813bca-be1b-4833-8967-802e28d44868@group-BD35F0CD1E5E, cid=39, seq=1*, RW, cmdType: WriteChunk
traceID: "954eb62fdc97f95e:954eb62fdc97f95e:0:0"
containerID: 9
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 9
    localID: 102892656657694730
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892656657694730_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 00b18887-f307-4103-8dd2-bd35f0cd1e5e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:56:03,439 [Thread-333] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-FollowerState: change to CANDIDATE, lastRpcTime:5147ms, electionTimeout:5147ms
2019-10-02 11:56:03,439 [Thread-333] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:56:03,440 [Thread-333] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:56:03,440 [Thread-333] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:56:03,456 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:56:03,457 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:56:03,457 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:56:03,457 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5174ms
2019-10-02 11:56:03,458 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:56:03,458 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:56:03,458 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:56:03,458 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:56:03,458 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:56:03,459 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:56:03,462 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:56:03,462 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:56:03,462 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-LeaderElection13] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:56:03,491 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f2eefe8a-b435-4874-97c6-e4208f826476/current/log_inprogress_0
2019-10-02 11:56:05,299 [pool-26-thread-10] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:05,299 [pool-26-thread-10] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: a0df490dccf723a3:a0df490dccf723a3:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
11:56:05.314 [pool-26-thread-10] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 10 locID: 102892657648336907 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:56:05,315 [pool-26-thread-10] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-E4208F826476: writeChunk writeStateMachineData failed: blockIdcontainerID: 10
localID: 102892657648336907
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892657648336907_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:56:05,315 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #10 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:56:05,315 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #10
2019-10-02 11:56:05,315 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=f2eefe8a-b435-4874-97c6-e4208f826476.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:05,316 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: f2eefe8a-b435-4874-97c6-e4208f826476, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:05,316 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: f2eefe8a-b435-4874-97c6-e4208f826476, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:56:05,317 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: f2eefe8a-b435-4874-97c6-e4208f826476, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:56:14,225 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-B173722B761D->e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476, cid=43, seq=1*, RW, cmdType: WriteChunk
traceID: "a0df490dccf723a3:a0df490dccf723a3:0:0"
containerID: 10
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 10
    localID: 102892657648336907
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892657648336907_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: f2eefe8a-b435-4874-97c6-e4208f826476, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:56:14,253 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-DE7D5A36F099:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-DE7D5A36F099:java.util.concurrent.CompletableFuture@53dbbfd2[Not completed]
2019-10-02 11:56:14,255 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-DE7D5A36F099:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:56:14,259 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:56:14,259 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:56:14,259 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:56:14,259 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:56:14,259 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:56:14,260 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:56:14,260 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:56:14,260 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:56:14,260 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/fd304ad1-a8a5-40eb-9d05-de7d5a36f099 does not exist. Creating ...
2019-10-02 11:56:14,274 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/fd304ad1-a8a5-40eb-9d05-de7d5a36f099/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:56:14,287 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/fd304ad1-a8a5-40eb-9d05-de7d5a36f099 has been successfully formatted.
2019-10-02 11:56:14,287 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-DE7D5A36F099: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/fd304ad1-a8a5-40eb-9d05-de7d5a36f099
2019-10-02 11:56:14,288 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:56:14,289 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:56:14,290 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:56:14,290 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:56:14,290 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:56:14,291 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:56:14,291 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:56:14,291 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:56:14,293 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:56:14,293 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:56:14,294 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:56:14,294 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DE7D5A36F099,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:56:14,300 [IPC Server handler 11 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: fd304ad1-a8a5-40eb-9d05-de7d5a36f099, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:56:15,323 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:56:15,324 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: shutdown
2019-10-02 11:56:15,324 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E4208F826476,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:56:15,324 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:56:15,325 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-PendingRequests: sendNotLeaderResponses
2019-10-02 11:56:15,326 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:56:15,329 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476: closes. applyIndex: 0
2019-10-02 11:56:15,330 [e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:56:15,331 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-E4208F826476-SegmentedRaftLogWorker close()
2019-10-02 11:56:15,337 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: f2eefe8a-b435-4874-97c6-e4208f826476, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:56:19,450 [Thread-351] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-FollowerState: change to CANDIDATE, lastRpcTime:5156ms, electionTimeout:5156ms
2019-10-02 11:56:19,451 [Thread-351] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:56:19,451 [Thread-351] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:56:19,451 [Thread-351] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:56:19,475 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:56:19,475 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:56:19,475 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:56:19,475 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5187ms
2019-10-02 11:56:19,475 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:56:19,475 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:56:19,476 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:56:19,476 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:56:19,476 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:56:19,476 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:56:19,478 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:56:19,478 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:56:19,479 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-LeaderElection14] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:56:19,505 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/fd304ad1-a8a5-40eb-9d05-de7d5a36f099/current/log_inprogress_0
2019-10-02 11:56:21,507 [pool-26-thread-11] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:21,507 [pool-26-thread-11] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: fab34d111a8ccc68:fab34d111a8ccc68:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:56:21,522 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #11 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:56:21,522 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #11
11:56:21.521 [pool-26-thread-11] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 11 locID: 102892658642255884 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:56:21,522 [pool-26-thread-11] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-DE7D5A36F099: writeChunk writeStateMachineData failed: blockIdcontainerID: 11
localID: 102892658642255884
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892658642255884_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:56:21,523 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=fd304ad1-a8a5-40eb-9d05-de7d5a36f099.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:21,523 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: fd304ad1-a8a5-40eb-9d05-de7d5a36f099, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:21,523 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: fd304ad1-a8a5-40eb-9d05-de7d5a36f099, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:56:21,524 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: fd304ad1-a8a5-40eb-9d05-de7d5a36f099, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:56:30,415 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-ACFEE63A88B6->e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099, cid=47, seq=1*, RW, cmdType: WriteChunk
traceID: "fab34d111a8ccc68:fab34d111a8ccc68:0:0"
containerID: 11
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 11
    localID: 102892658642255884
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892658642255884_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: fd304ad1-a8a5-40eb-9d05-de7d5a36f099, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:56:30,459 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-46B9D3CDD945:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-46B9D3CDD945:java.util.concurrent.CompletableFuture@4a8e962a[Not completed]
2019-10-02 11:56:30,461 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-46B9D3CDD945:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:56:30,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:56:30,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:56:30,463 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:56:30,463 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:56:30,463 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:56:30,463 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:56:30,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:56:30,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:56:30,464 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f10b5863-1912-418e-99d3-46b9d3cdd945 does not exist. Creating ...
2019-10-02 11:56:30,477 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f10b5863-1912-418e-99d3-46b9d3cdd945/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:56:30,490 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f10b5863-1912-418e-99d3-46b9d3cdd945 has been successfully formatted.
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-46B9D3CDD945: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f10b5863-1912-418e-99d3-46b9d3cdd945
2019-10-02 11:56:30,491 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:56:30,492 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:56:30,493 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:56:30,493 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:56:30,493 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:56:30,493 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:56:30,493 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:56:30,496 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:56:30,496 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:56:30,496 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:56:30,496 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-46B9D3CDD945,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:56:30,502 [IPC Server handler 0 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f10b5863-1912-418e-99d3-46b9d3cdd945, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:56:31,538 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:56:31,539 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: shutdown
2019-10-02 11:56:31,540 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DE7D5A36F099,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:56:31,540 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:56:31,540 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-PendingRequests: sendNotLeaderResponses
2019-10-02 11:56:31,543 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:56:31,545 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099: closes. applyIndex: 0
2019-10-02 11:56:31,546 [e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:56:31,547 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-DE7D5A36F099-SegmentedRaftLogWorker close()
2019-10-02 11:56:31,555 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: fd304ad1-a8a5-40eb-9d05-de7d5a36f099, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:56:35,621 [Thread-370] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-FollowerState: change to CANDIDATE, lastRpcTime:5125ms, electionTimeout:5125ms
2019-10-02 11:56:35,622 [Thread-370] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:56:35,622 [Thread-370] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:56:35,622 [Thread-370] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:56:35,638 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:56:35,638 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:56:35,638 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:56:35,638 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5147ms
2019-10-02 11:56:35,638 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:56:35,638 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:56:35,639 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:56:35,639 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:56:35,639 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:56:35,639 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:56:35,642 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:56:35,643 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:56:35,644 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-LeaderElection15] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:56:35,694 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/f10b5863-1912-418e-99d3-46b9d3cdd945/current/log_inprogress_0
2019-10-02 11:56:37,710 [pool-26-thread-12] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:37,711 [pool-26-thread-12] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 40176b6cd2ed1311:40176b6cd2ed1311:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:56:37,740 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #12 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:56:37,740 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #12
11:56:37.739 [pool-26-thread-12] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 12 locID: 102892659704004621 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:56:37,740 [pool-26-thread-12] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-46B9D3CDD945: writeChunk writeStateMachineData failed: blockIdcontainerID: 12
localID: 102892659704004621
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892659704004621_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:56:37,741 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=f10b5863-1912-418e-99d3-46b9d3cdd945.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:37,742 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: f10b5863-1912-418e-99d3-46b9d3cdd945, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:37,742 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: f10b5863-1912-418e-99d3-46b9d3cdd945, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:56:37,742 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: f10b5863-1912-418e-99d3-46b9d3cdd945, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:56:46,623 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-9D761B16A46B->e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945, cid=51, seq=1*, RW, cmdType: WriteChunk
traceID: "40176b6cd2ed1311:40176b6cd2ed1311:0:0"
containerID: 12
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 12
    localID: 102892659704004621
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892659704004621_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: f10b5863-1912-418e-99d3-46b9d3cdd945, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:56:46,652 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-F5CE07C89AC9:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-F5CE07C89AC9:java.util.concurrent.CompletableFuture@20613d18[Not completed]
2019-10-02 11:56:46,655 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-F5CE07C89AC9:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:56:46,656 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:56:46,656 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:56:46,656 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:56:46,656 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:56:46,656 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:56:46,656 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:56:46,656 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:56:46,657 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:56:46,657 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9 does not exist. Creating ...
2019-10-02 11:56:46,669 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:56:46,682 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9 has been successfully formatted.
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-F5CE07C89AC9: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:56:46,683 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:56:46,684 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:56:46,685 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:56:46,685 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:56:46,685 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:56:46,685 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:56:46,685 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:56:46,685 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:56:46,688 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:56:46,688 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:56:46,688 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:56:46,688 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F5CE07C89AC9,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:56:46,693 [IPC Server handler 7 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:56:47,749 [grpc-default-executor-2] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:56:47,750 [grpc-default-executor-2] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: shutdown
2019-10-02 11:56:47,750 [grpc-default-executor-2] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-46B9D3CDD945,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:56:47,751 [grpc-default-executor-2] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:56:47,751 [grpc-default-executor-2] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-PendingRequests: sendNotLeaderResponses
2019-10-02 11:56:47,754 [grpc-default-executor-2] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:56:47,756 [grpc-default-executor-2] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945: closes. applyIndex: 0
2019-10-02 11:56:47,758 [e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:56:47,759 [grpc-default-executor-2] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-46B9D3CDD945-SegmentedRaftLogWorker close()
2019-10-02 11:56:47,767 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: f10b5863-1912-418e-99d3-46b9d3cdd945, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:56:51,771 [Thread-388] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-FollowerState: change to CANDIDATE, lastRpcTime:5083ms, electionTimeout:5083ms
2019-10-02 11:56:51,772 [Thread-388] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:56:51,772 [Thread-388] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:56:51,773 [Thread-388] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:56:51,782 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:56:51,782 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:56:51,782 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:56:51,782 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5099ms
2019-10-02 11:56:51,782 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:56:51,782 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:56:51,782 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:56:51,783 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:56:51,783 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:56:51,783 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:56:51,786 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:56:51,786 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:56:51,787 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-LeaderElection16] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:56:51,820 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9/current/log_inprogress_0
2019-10-02 11:56:53,917 [pool-26-thread-13] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:53,917 [pool-26-thread-13] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 90d572699c9566c2:90d572699c9566c2:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
11:56:53.926 [pool-26-thread-13] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 13 locID: 102892660765097998 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:56:53,927 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #13 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:56:53,927 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #13
2019-10-02 11:56:53,927 [pool-26-thread-13] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-F5CE07C89AC9: writeChunk writeStateMachineData failed: blockIdcontainerID: 13
localID: 102892660765097998
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892660765097998_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:56:53,927 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:53,928 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:56:53,928 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:56:53,928 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:57:02,856 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-49FD9C18CEA8->e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9, cid=55, seq=1*, RW, cmdType: WriteChunk
traceID: "90d572699c9566c2:90d572699c9566c2:0:0"
containerID: 13
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 13
    localID: 102892660765097998
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892660765097998_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:57:02,889 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-601B04CEA93E:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-601B04CEA93E:java.util.concurrent.CompletableFuture@100901be[Not completed]
2019-10-02 11:57:02,891 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-601B04CEA93E:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:57:02,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:57:02,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:57:02,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:57:02,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:57:02,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:57:02,892 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:57:02,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:57:02,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:57:02,892 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/000b624f-97b8-4a9a-bef6-601b04cea93e does not exist. Creating ...
2019-10-02 11:57:02,926 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/000b624f-97b8-4a9a-bef6-601b04cea93e/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:57:02,939 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/000b624f-97b8-4a9a-bef6-601b04cea93e has been successfully formatted.
2019-10-02 11:57:02,939 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-601B04CEA93E: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:57:02,939 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:57:02,939 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:57:02,939 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:57:02,939 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/000b624f-97b8-4a9a-bef6-601b04cea93e
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:57:02,940 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:57:02,941 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:57:02,941 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:57:02,941 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:57:02,941 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:57:02,941 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:57:02,941 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:57:02,941 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:57:02,942 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:57:02,943 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:02,944 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:57:02,944 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:57:02,944 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-601B04CEA93E,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:02,949 [IPC Server handler 15 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 000b624f-97b8-4a9a-bef6-601b04cea93e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:03,935 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:57:03,935 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: shutdown
2019-10-02 11:57:03,936 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F5CE07C89AC9,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:03,936 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:57:03,936 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-PendingRequests: sendNotLeaderResponses
2019-10-02 11:57:03,938 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:57:03,939 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9: closes. applyIndex: 0
2019-10-02 11:57:03,939 [e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:57:03,940 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-F5CE07C89AC9-SegmentedRaftLogWorker close()
2019-10-02 11:57:03,946 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: dccfef36-f6c8-4a5a-ae98-f5ce07c89ac9, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:57:07,973 [Thread-406] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-FollowerState: change to CANDIDATE, lastRpcTime:5029ms, electionTimeout:5029ms
2019-10-02 11:57:07,974 [Thread-406] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:57:07,974 [Thread-406] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:57:07,974 [Thread-406] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:57:07,989 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:07,989 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:57:07,989 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:57:07,989 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5050ms
2019-10-02 11:57:07,990 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:57:07,990 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:57:07,990 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:57:07,990 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:57:07,990 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:57:07,990 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:57:07,992 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:57:07,992 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:57:07,993 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-LeaderElection17] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:57:08,031 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/000b624f-97b8-4a9a-bef6-601b04cea93e/current/log_inprogress_0
2019-10-02 11:57:08,203 [pool-26-thread-14] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:08,203 [pool-26-thread-14] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 737258523fbcf777:737258523fbcf777:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:57:08,217 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #14 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:57:08,217 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #14
11:57:08.217 [pool-26-thread-14] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 14 locID: 102892661830451215 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:57:08,218 [pool-26-thread-14] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-601B04CEA93E: writeChunk writeStateMachineData failed: blockIdcontainerID: 14
localID: 102892661830451215
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892661830451215_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:57:08,218 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=000b624f-97b8-4a9a-bef6-601b04cea93e.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:08,218 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 000b624f-97b8-4a9a-bef6-601b04cea93e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:08,219 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 000b624f-97b8-4a9a-bef6-601b04cea93e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:08,219 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 000b624f-97b8-4a9a-bef6-601b04cea93e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:57:18,229 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:57:18,230 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: shutdown
2019-10-02 11:57:18,231 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-601B04CEA93E,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:18,231 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:57:18,231 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-PendingRequests: sendNotLeaderResponses
2019-10-02 11:57:18,233 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:57:18,235 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E: closes. applyIndex: 0
2019-10-02 11:57:18,236 [e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:57:18,239 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E-SegmentedRaftLogWorker close()
2019-10-02 11:57:18,246 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 000b624f-97b8-4a9a-bef6-601b04cea93e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:57:18,253 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-8A135A7A27C1:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-8A135A7A27C1:java.util.concurrent.CompletableFuture@900cf04[Not completed]
2019-10-02 11:57:18,255 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-8A135A7A27C1:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:57:18,256 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:57:18,256 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:57:18,256 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:57:18,256 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:57:18,256 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:57:18,256 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:57:18,257 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:57:18,257 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:57:18,257 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c71b1479-e428-4df7-9438-8a135a7a27c1 does not exist. Creating ...
2019-10-02 11:57:18,263 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c71b1479-e428-4df7-9438-8a135a7a27c1/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:57:18,277 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c71b1479-e428-4df7-9438-8a135a7a27c1 has been successfully formatted.
2019-10-02 11:57:18,277 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-8A135A7A27C1: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:57:18,277 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:57:18,277 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:57:18,277 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:57:18,277 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:57:18,278 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:18,278 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:57:18,278 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c71b1479-e428-4df7-9438-8a135a7a27c1
2019-10-02 11:57:18,278 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:57:18,278 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:57:18,278 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:18,278 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:57:18,279 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:57:18,279 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:57:18,279 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:57:18,279 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:57:18,279 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:57:18,279 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:57:18,280 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:57:18,280 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:57:18,280 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:57:18,280 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:57:18,280 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:57:18,283 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:18,283 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:57:18,283 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:57:18,284 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8A135A7A27C1,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:18,291 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: c71b1479-e428-4df7-9438-8a135a7a27c1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:19,147 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-7824F1F1001A->e5813bca-be1b-4833-8967-802e28d44868@group-601B04CEA93E, cid=59, seq=1*, RW, cmdType: WriteChunk
traceID: "737258523fbcf777:737258523fbcf777:0:0"
containerID: 14
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 14
    localID: 102892661830451215
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892661830451215_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 000b624f-97b8-4a9a-bef6-601b04cea93e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:57:23,331 [Thread-422] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-FollowerState: change to CANDIDATE, lastRpcTime:5047ms, electionTimeout:5047ms
2019-10-02 11:57:23,332 [Thread-422] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:57:23,332 [Thread-422] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:57:23,332 [Thread-422] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:57:23,368 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:23,370 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:57:23,371 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:57:23,371 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5093ms
2019-10-02 11:57:23,371 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:57:23,371 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:57:23,371 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:57:23,372 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:57:23,372 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:57:23,372 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:57:23,376 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:57:23,377 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:57:23,378 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-LeaderElection18] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:57:23,424 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c71b1479-e428-4df7-9438-8a135a7a27c1/current/log_inprogress_0
2019-10-02 11:57:25,351 [pool-26-thread-15] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:25,352 [pool-26-thread-15] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 7f3baa73bf87ae19:7f3baa73bf87ae19:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:57:25,353 [EventQueue-ContainerReportForContainerReportHandler] ERROR events.SingleThreadExecutor (SingleThreadExecutor.java:lambda$onMessage$1(88)) - Error on execution message org.apache.hadoop.hdds.scm.server.SCMDatanodeHeartbeatDispatcher$ContainerReportFromDatanode@484a990e
java.util.ConcurrentModificationException
	at java.util.HashMap$HashIterator.nextNode(HashMap.java:1445)
	at java.util.HashMap$KeyIterator.next(HashMap.java:1469)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042)
	at java.util.AbstractCollection.addAll(AbstractCollection.java:343)
	at java.util.HashSet.<init>(HashSet.java:120)
	at org.apache.hadoop.hdds.scm.container.ContainerReportHandler.onMessage(ContainerReportHandler.java:94)
	at org.apache.hadoop.hdds.scm.container.ContainerReportHandler.onMessage(ContainerReportHandler.java:46)
	at org.apache.hadoop.hdds.server.events.SingleThreadExecutor.lambda$onMessage$1(SingleThreadExecutor.java:85)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2019-10-02 11:57:25,366 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #15 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
11:57:25.366 [pool-26-thread-15] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 15 locID: 102892662893051920 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:57:25,367 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #15
2019-10-02 11:57:25,367 [pool-26-thread-15] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-8A135A7A27C1: writeChunk writeStateMachineData failed: blockIdcontainerID: 15
localID: 102892662893051920
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892662893051920_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:57:25,367 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=c71b1479-e428-4df7-9438-8a135a7a27c1.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:25,368 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: c71b1479-e428-4df7-9438-8a135a7a27c1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:25,368 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: c71b1479-e428-4df7-9438-8a135a7a27c1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:25,368 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: c71b1479-e428-4df7-9438-8a135a7a27c1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:57:26,755 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-38BE5C5B090F:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-38BE5C5B090F:java.util.concurrent.CompletableFuture@4938c48[Not completed]
2019-10-02 11:57:26,757 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-38BE5C5B090F:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:57:26,757 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:57:26,757 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:57:26,757 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:57:26,757 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:57:26,757 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:57:26,757 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:57:26,758 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:57:26,758 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:57:26,758 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/35d38bff-5c23-43f6-8467-38be5c5b090f does not exist. Creating ...
2019-10-02 11:57:26,771 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/35d38bff-5c23-43f6-8467-38be5c5b090f/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:57:26,784 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/35d38bff-5c23-43f6-8467-38be5c5b090f has been successfully formatted.
2019-10-02 11:57:26,784 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-38BE5C5B090F: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:57:26,784 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:57:26,784 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:57:26,784 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:57:26,784 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/35d38bff-5c23-43f6-8467-38be5c5b090f
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:57:26,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:57:26,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:57:26,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:57:26,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:57:26,786 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:57:26,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:57:26,787 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:57:26,787 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:57:26,787 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:57:26,789 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:26,789 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:57:26,789 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:57:26,789 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-38BE5C5B090F,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:26,799 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 35d38bff-5c23-43f6-8467-38be5c5b090f, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:31,867 [Thread-438] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-FollowerState: change to CANDIDATE, lastRpcTime:5077ms, electionTimeout:5077ms
2019-10-02 11:57:31,868 [Thread-438] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:57:31,869 [Thread-438] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:57:31,869 [Thread-438] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:57:31,893 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:31,894 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:57:31,894 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:57:31,894 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5109ms
2019-10-02 11:57:31,894 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:57:31,894 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:57:31,894 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:57:31,895 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:57:31,895 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:57:31,895 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:57:31,897 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:57:31,898 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:57:31,899 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-LeaderElection19] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:57:31,934 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/35d38bff-5c23-43f6-8467-38be5c5b090f/current/log_inprogress_0
2019-10-02 11:57:34,271 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-4D3950B077BA->e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1, cid=63, seq=1*, RW, cmdType: WriteChunk
traceID: "7f3baa73bf87ae19:7f3baa73bf87ae19:0:0"
containerID: 15
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 15
    localID: 102892662893051920
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892662893051920_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: c71b1479-e428-4df7-9438-8a135a7a27c1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:57:35,379 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:57:35,379 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: shutdown
2019-10-02 11:57:35,380 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8A135A7A27C1,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:35,380 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:57:35,380 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-PendingRequests: sendNotLeaderResponses
2019-10-02 11:57:35,383 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:57:35,383 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1: closes. applyIndex: 0
2019-10-02 11:57:35,385 [e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:57:35,387 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-8A135A7A27C1-SegmentedRaftLogWorker close()
2019-10-02 11:57:35,394 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: c71b1479-e428-4df7-9438-8a135a7a27c1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:57:35,485 [pool-26-thread-16] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 159
2019-10-02 11:57:35,486 [pool-26-thread-16] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: f28bfb003f09cb9:f28bfb003f09cb9:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 159 : Result: INVALID_WRITE_SIZE
2019-10-02 11:57:35,500 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #16 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:57:35,501 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #16
11:57:35.500 [pool-26-thread-16] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 16 locID: 102892663884087313 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 159
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:57:35,501 [EventQueue-ContainerReportForContainerReportHandler] WARN  container.ContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #16 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:57:35,502 [pool-26-thread-16] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-38BE5C5B090F: writeChunk writeStateMachineData failed: blockIdcontainerID: 16
localID: 102892663884087313
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892663884087313_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 159 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:57:35,502 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=35d38bff-5c23-43f6-8467-38be5c5b090f.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 159
2019-10-02 11:57:35,503 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 35d38bff-5c23-43f6-8467-38be5c5b090f, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 159
2019-10-02 11:57:35,503 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 35d38bff-5c23-43f6-8467-38be5c5b090f, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:35,503 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 35d38bff-5c23-43f6-8467-38be5c5b090f, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:57:45,515 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:57:45,517 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: shutdown
2019-10-02 11:57:45,517 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-38BE5C5B090F,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:45,518 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:57:45,518 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-PendingRequests: sendNotLeaderResponses
2019-10-02 11:57:45,520 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:57:45,522 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F: closes. applyIndex: 0
2019-10-02 11:57:45,524 [e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:57:45,532 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-38BE5C5B090F-SegmentedRaftLogWorker close()
2019-10-02 11:57:45,541 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 35d38bff-5c23-43f6-8467-38be5c5b090f, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:57:45,555 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-2C4ECD6A8D26:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-2C4ECD6A8D26:java.util.concurrent.CompletableFuture@761c1b5c[Not completed]
2019-10-02 11:57:45,560 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-2C4ECD6A8D26:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:57:45,560 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:57:45,560 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:57:45,561 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:57:45,561 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:57:45,561 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:57:45,561 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:57:45,562 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:57:45,562 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:57:45,563 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/faf74348-554f-42ac-a948-2c4ecd6a8d26 does not exist. Creating ...
2019-10-02 11:57:45,576 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/faf74348-554f-42ac-a948-2c4ecd6a8d26/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:57:45,589 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/faf74348-554f-42ac-a948-2c4ecd6a8d26 has been successfully formatted.
2019-10-02 11:57:45,589 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-2C4ECD6A8D26: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:57:45,589 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:57:45,590 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:57:45,590 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:57:45,590 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:57:45,590 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:45,590 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:57:45,590 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/faf74348-554f-42ac-a948-2c4ecd6a8d26
2019-10-02 11:57:45,591 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:57:45,591 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:57:45,591 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:57:45,591 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:57:45,591 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:57:45,591 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:57:45,591 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:57:45,592 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:57:45,592 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:57:45,592 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:57:45,592 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:57:45,593 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:57:45,593 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:57:45,593 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:57:45,593 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:57:45,596 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:45,596 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:57:45,597 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:57:45,600 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2C4ECD6A8D26,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:57:45,611 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: faf74348-554f-42ac-a948-2c4ecd6a8d26, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:47,462 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.GroupMismatchException: e5813bca-be1b-4833-8967-802e28d44868: group-38BE5C5B090F not found. on the pipeline Pipeline[ Id: 35d38bff-5c23-43f6-8467-38be5c5b090f, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:57:50,774 [Thread-453] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-FollowerState: change to CANDIDATE, lastRpcTime:5177ms, electionTimeout:5177ms
2019-10-02 11:57:50,776 [Thread-453] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:57:50,776 [Thread-453] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:57:50,776 [Thread-453] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:57:50,800 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:57:50,801 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:57:50,801 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:57:50,801 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5211ms
2019-10-02 11:57:50,802 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:57:50,802 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:57:50,802 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:57:50,803 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:57:50,803 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:57:50,803 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:57:50,808 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:57:50,808 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:57:50,840 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-LeaderElection20] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:57:50,852 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/faf74348-554f-42ac-a948-2c4ecd6a8d26/current/log_inprogress_0
2019-10-02 11:57:51,644 [pool-26-thread-17] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:51,644 [pool-26-thread-17] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 83b67950b3a65c87:83b67950b3a65c87:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:57:51,659 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #17 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:57:51,659 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #17
11:57:51.658 [pool-26-thread-17] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 17 locID: 102892664748900370 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:57:51,660 [pool-26-thread-17] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-2C4ECD6A8D26: writeChunk writeStateMachineData failed: blockIdcontainerID: 17
localID: 102892664748900370
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892664748900370_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:57:51,660 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=faf74348-554f-42ac-a948-2c4ecd6a8d26.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:51,661 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: faf74348-554f-42ac-a948-2c4ecd6a8d26, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:57:51,661 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: faf74348-554f-42ac-a948-2c4ecd6a8d26, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:57:51,661 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: faf74348-554f-42ac-a948-2c4ecd6a8d26, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:58:01,671 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:58:01,673 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: shutdown
2019-10-02 11:58:01,673 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2C4ECD6A8D26,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:01,673 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:58:01,673 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-PendingRequests: sendNotLeaderResponses
2019-10-02 11:58:01,675 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:58:01,676 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26: closes. applyIndex: 0
2019-10-02 11:58:01,677 [e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:58:01,678 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26-SegmentedRaftLogWorker close()
2019-10-02 11:58:01,687 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: faf74348-554f-42ac-a948-2c4ecd6a8d26, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:58:01,692 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-0D814C4E3721:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-0D814C4E3721:java.util.concurrent.CompletableFuture@1f29546d[Not completed]
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-0D814C4E3721:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:58:01,695 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:58:01,696 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:58:01,696 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/31c701ba-0c6c-452a-b8ee-0d814c4e3721 does not exist. Creating ...
2019-10-02 11:58:01,728 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/31c701ba-0c6c-452a-b8ee-0d814c4e3721/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:58:01,741 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/31c701ba-0c6c-452a-b8ee-0d814c4e3721 has been successfully formatted.
2019-10-02 11:58:01,741 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-0D814C4E3721: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:58:01,741 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:58:01,741 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:58:01,741 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:58:01,741 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/31c701ba-0c6c-452a-b8ee-0d814c4e3721
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:58:01,742 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:58:01,743 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:58:01,743 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:58:01,743 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:58:01,743 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:58:01,743 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:58:01,743 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:58:01,744 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:58:01,745 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:01,746 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:58:01,746 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:58:01,746 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0D814C4E3721,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:01,752 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 31c701ba-0c6c-452a-b8ee-0d814c4e3721, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:02,585 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-8631CB482469->e5813bca-be1b-4833-8967-802e28d44868@group-2C4ECD6A8D26, cid=71, seq=1*, RW, cmdType: WriteChunk
traceID: "83b67950b3a65c87:83b67950b3a65c87:0:0"
containerID: 17
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 17
    localID: 102892664748900370
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892664748900370_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: faf74348-554f-42ac-a948-2c4ecd6a8d26, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:58:06,771 [Thread-470] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-FollowerState: change to CANDIDATE, lastRpcTime:5025ms, electionTimeout:5025ms
2019-10-02 11:58:06,772 [Thread-470] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:58:06,772 [Thread-470] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:58:06,772 [Thread-470] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:58:06,791 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:06,793 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:58:06,793 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:58:06,793 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5051ms
2019-10-02 11:58:06,793 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:58:06,793 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:58:06,794 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:58:06,794 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:58:06,794 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:58:06,794 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:58:06,798 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:58:06,799 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:58:06,800 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-LeaderElection21] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:58:06,841 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/31c701ba-0c6c-452a-b8ee-0d814c4e3721/current/log_inprogress_0
2019-10-02 11:58:08,788 [pool-26-thread-18] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:08,789 [pool-26-thread-18] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: df2ddd81832e0ed1:df2ddd81832e0ed1:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:58:08,804 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #18 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:58:08,804 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #18
11:58:08.804 [pool-26-thread-18] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 18 locID: 102892665739673619 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:58:08,805 [pool-26-thread-18] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-0D814C4E3721: writeChunk writeStateMachineData failed: blockIdcontainerID: 18
localID: 102892665739673619
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892665739673619_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:58:08,806 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=31c701ba-0c6c-452a-b8ee-0d814c4e3721.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:08,806 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 31c701ba-0c6c-452a-b8ee-0d814c4e3721, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:08,807 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 31c701ba-0c6c-452a-b8ee-0d814c4e3721, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:08,807 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 31c701ba-0c6c-452a-b8ee-0d814c4e3721, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:58:17,700 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-1D133894790D->e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721, cid=75, seq=1*, RW, cmdType: WriteChunk
traceID: "df2ddd81832e0ed1:df2ddd81832e0ed1:0:0"
containerID: 18
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 18
    localID: 102892665739673619
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892665739673619_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 31c701ba-0c6c-452a-b8ee-0d814c4e3721, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:58:17,729 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-8DA4CFE6EB10:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-8DA4CFE6EB10:java.util.concurrent.CompletableFuture@7fec974e[Not completed]
2019-10-02 11:58:17,732 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-8DA4CFE6EB10:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:58:17,733 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:58:17,733 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:58:17,733 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:58:17,733 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:58:17,733 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:58:17,734 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:58:17,734 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:58:17,734 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:58:17,734 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/518b78d5-9b69-4659-bb6c-8da4cfe6eb10 does not exist. Creating ...
2019-10-02 11:58:17,768 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/518b78d5-9b69-4659-bb6c-8da4cfe6eb10/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:58:17,782 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/518b78d5-9b69-4659-bb6c-8da4cfe6eb10 has been successfully formatted.
2019-10-02 11:58:17,782 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-8DA4CFE6EB10: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:58:17,783 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:58:17,783 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:58:17,783 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:58:17,783 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:58:17,784 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:17,784 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:58:17,784 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/518b78d5-9b69-4659-bb6c-8da4cfe6eb10
2019-10-02 11:58:17,784 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:58:17,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:58:17,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:17,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:58:17,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:58:17,785 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:58:17,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:58:17,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:58:17,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:58:17,786 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:58:17,787 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:58:17,787 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:58:17,788 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:58:17,788 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:58:17,788 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:58:17,792 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:17,793 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:58:17,793 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:58:17,794 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8DA4CFE6EB10,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:17,801 [IPC Server handler 2 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 518b78d5-9b69-4659-bb6c-8da4cfe6eb10, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:18,815 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:58:18,815 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: shutdown
2019-10-02 11:58:18,816 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0D814C4E3721,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:18,816 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:58:18,816 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-PendingRequests: sendNotLeaderResponses
2019-10-02 11:58:18,819 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:58:18,822 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721: closes. applyIndex: 0
2019-10-02 11:58:18,824 [e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:58:18,825 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-0D814C4E3721-SegmentedRaftLogWorker close()
2019-10-02 11:58:18,835 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 31c701ba-0c6c-452a-b8ee-0d814c4e3721, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:58:22,935 [Thread-488] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-FollowerState: change to CANDIDATE, lastRpcTime:5141ms, electionTimeout:5141ms
2019-10-02 11:58:22,936 [Thread-488] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:58:22,937 [Thread-488] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:58:22,937 [Thread-488] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:58:22,948 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:22,948 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:58:22,949 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:58:22,949 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5166ms
2019-10-02 11:58:22,949 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:58:22,949 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:58:22,950 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:58:22,950 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:58:22,950 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:58:22,950 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:58:22,954 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:58:22,954 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:58:22,955 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-LeaderElection22] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:58:23,008 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/518b78d5-9b69-4659-bb6c-8da4cfe6eb10/current/log_inprogress_0
2019-10-02 11:58:25,014 [pool-26-thread-19] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:25,015 [pool-26-thread-19] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: f96fcb2f863b80e3:f96fcb2f863b80e3:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:58:25,029 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #19 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
11:58:25.029 [pool-26-thread-19] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 19 locID: 102892666735951892 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:58:25,029 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #19
2019-10-02 11:58:25,030 [pool-26-thread-19] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-8DA4CFE6EB10: writeChunk writeStateMachineData failed: blockIdcontainerID: 19
localID: 102892666735951892
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892666735951892_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:58:25,030 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=518b78d5-9b69-4659-bb6c-8da4cfe6eb10.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:25,031 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 518b78d5-9b69-4659-bb6c-8da4cfe6eb10, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:25,031 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 518b78d5-9b69-4659-bb6c-8da4cfe6eb10, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:25,031 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 518b78d5-9b69-4659-bb6c-8da4cfe6eb10, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:58:28,880 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #1 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,884 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #2 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,884 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #3 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,884 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #4 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,884 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #5 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,884 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #6 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,884 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #7 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,884 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #8 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #9 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #10 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #11 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #12 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #13 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #14 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #15 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,885 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #16 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,886 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #17 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,886 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #18 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,886 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:sendCloseCommand(659)) - Sending close container command for container #19 to datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}.
2019-10-02 11:58:28,886 [ReplicationMonitor] INFO  container.ReplicationManager (ReplicationManager.java:run(225)) - Replication Monitor Thread took 8 milliseconds for processing 19 containers.
2019-10-02 11:58:33,915 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-23B0409CC980->e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10, cid=79, seq=1*, RW, cmdType: WriteChunk
traceID: "f96fcb2f863b80e3:f96fcb2f863b80e3:0:0"
containerID: 19
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 19
    localID: 102892666735951892
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892666735951892_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 518b78d5-9b69-4659-bb6c-8da4cfe6eb10, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:58:33,941 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-DEFDB5FFAE98:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-DEFDB5FFAE98:java.util.concurrent.CompletableFuture@b5447a5[Not completed]
2019-10-02 11:58:33,943 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-DEFDB5FFAE98:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:58:33,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:58:33,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:58:33,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:58:33,944 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:58:33,945 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:58:33,945 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:58:33,945 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:58:33,945 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:58:33,945 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/5420c15e-c4df-482b-a75e-defdb5ffae98 does not exist. Creating ...
2019-10-02 11:58:33,978 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/5420c15e-c4df-482b-a75e-defdb5ffae98/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:58:33,992 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/5420c15e-c4df-482b-a75e-defdb5ffae98 has been successfully formatted.
2019-10-02 11:58:33,992 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-DEFDB5FFAE98: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:58:33,993 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:58:33,993 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:58:33,993 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:58:33,993 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:58:33,993 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:33,994 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:58:33,994 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/5420c15e-c4df-482b-a75e-defdb5ffae98
2019-10-02 11:58:33,994 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:58:33,994 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:58:33,994 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:33,995 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:58:33,995 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:58:33,995 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:58:33,995 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:58:33,995 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:58:33,995 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:58:33,996 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:58:33,996 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:58:33,997 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:58:33,997 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:58:33,997 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:58:33,997 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:58:34,000 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:34,000 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:58:34,001 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:58:34,001 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DEFDB5FFAE98,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:34,007 [IPC Server handler 15 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 5420c15e-c4df-482b-a75e-defdb5ffae98, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:35,038 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:58:35,039 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: shutdown
2019-10-02 11:58:35,039 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8DA4CFE6EB10,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:35,039 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:58:35,040 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-PendingRequests: sendNotLeaderResponses
2019-10-02 11:58:35,042 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:58:35,044 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10: closes. applyIndex: 0
2019-10-02 11:58:35,045 [e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:58:35,046 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-8DA4CFE6EB10-SegmentedRaftLogWorker close()
2019-10-02 11:58:35,055 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 518b78d5-9b69-4659-bb6c-8da4cfe6eb10, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:58:39,156 [Thread-507] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-FollowerState: change to CANDIDATE, lastRpcTime:5155ms, electionTimeout:5155ms
2019-10-02 11:58:39,157 [Thread-507] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:58:39,157 [Thread-507] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:58:39,158 [Thread-507] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:58:39,194 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:39,195 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:58:39,195 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:58:39,195 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5202ms
2019-10-02 11:58:39,195 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:58:39,196 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:58:39,196 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:58:39,196 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:58:39,196 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:58:39,197 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:58:39,201 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:58:39,201 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:58:39,202 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-LeaderElection23] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:58:39,241 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/5420c15e-c4df-482b-a75e-defdb5ffae98/current/log_inprogress_0
2019-10-02 11:58:41,246 [pool-26-thread-20] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:41,246 [pool-26-thread-20] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 3cdd2da71fa0450f:3cdd2da71fa0450f:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:58:41,261 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #20 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:58:41,261 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #20
11:58:41.261 [pool-26-thread-20] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 20 locID: 102892667798028309 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:58:41,262 [pool-26-thread-20] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-DEFDB5FFAE98: writeChunk writeStateMachineData failed: blockIdcontainerID: 20
localID: 102892667798028309
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892667798028309_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:58:41,262 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=5420c15e-c4df-482b-a75e-defdb5ffae98.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:41,263 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 5420c15e-c4df-482b-a75e-defdb5ffae98, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:41,263 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 5420c15e-c4df-482b-a75e-defdb5ffae98, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:41,263 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 5420c15e-c4df-482b-a75e-defdb5ffae98, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:58:50,157 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-42E6015FFDED->e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98, cid=83, seq=1*, RW, cmdType: WriteChunk
traceID: "3cdd2da71fa0450f:3cdd2da71fa0450f:0:0"
containerID: 20
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 20
    localID: 102892667798028309
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892667798028309_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 5420c15e-c4df-482b-a75e-defdb5ffae98, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:58:50,190 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-DAABD0F65A97:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-DAABD0F65A97:java.util.concurrent.CompletableFuture@7e9b1682[Not completed]
2019-10-02 11:58:50,192 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-DAABD0F65A97:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:58:50,193 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:58:50,193 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:58:50,193 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:58:50,193 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:58:50,193 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:58:50,193 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:58:50,194 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:58:50,194 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:58:50,194 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/ff04bc65-7cf2-4d41-9dc1-daabd0f65a97 does not exist. Creating ...
2019-10-02 11:58:50,226 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/ff04bc65-7cf2-4d41-9dc1-daabd0f65a97/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:58:50,242 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/ff04bc65-7cf2-4d41-9dc1-daabd0f65a97 has been successfully formatted.
2019-10-02 11:58:50,242 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-DAABD0F65A97: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:58:50,242 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:58:50,242 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:58:50,242 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:58:50,242 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/ff04bc65-7cf2-4d41-9dc1-daabd0f65a97
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:58:50,243 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:58:50,244 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:58:50,244 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:58:50,244 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:58:50,244 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:58:50,244 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:58:50,245 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:58:50,245 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:58:50,245 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:58:50,247 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:50,248 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:58:50,248 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:58:50,248 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DAABD0F65A97,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:50,256 [IPC Server handler 14 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: ff04bc65-7cf2-4d41-9dc1-daabd0f65a97, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:51,274 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:58:51,274 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: shutdown
2019-10-02 11:58:51,275 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DEFDB5FFAE98,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:58:51,275 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:58:51,275 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-PendingRequests: sendNotLeaderResponses
2019-10-02 11:58:51,278 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:58:51,281 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98: closes. applyIndex: 0
2019-10-02 11:58:51,283 [e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:58:51,285 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-DEFDB5FFAE98-SegmentedRaftLogWorker close()
2019-10-02 11:58:51,295 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 5420c15e-c4df-482b-a75e-defdb5ffae98, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:58:55,347 [Thread-525] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-FollowerState: change to CANDIDATE, lastRpcTime:5098ms, electionTimeout:5098ms
2019-10-02 11:58:55,349 [Thread-525] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:58:55,349 [Thread-525] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:58:55,349 [Thread-525] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:58:55,363 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:58:55,363 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:58:55,363 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:58:55,363 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5121ms
2019-10-02 11:58:55,364 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:58:55,364 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:58:55,364 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:58:55,364 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:58:55,364 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:58:55,365 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:58:55,368 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:58:55,368 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:58:55,369 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-LeaderElection24] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:58:55,425 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/ff04bc65-7cf2-4d41-9dc1-daabd0f65a97/current/log_inprogress_0
2019-10-02 11:58:57,470 [pool-26-thread-21] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:57,470 [pool-26-thread-21] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 495e08ae3530c078:495e08ae3530c078:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:58:57,485 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #21 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:58:57,485 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #21
11:58:57.485 [pool-26-thread-21] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 21 locID: 102892668862857238 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:58:57,486 [pool-26-thread-21] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-DAABD0F65A97: writeChunk writeStateMachineData failed: blockIdcontainerID: 21
localID: 102892668862857238
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892668862857238_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:58:57,486 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=ff04bc65-7cf2-4d41-9dc1-daabd0f65a97.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:57,487 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: ff04bc65-7cf2-4d41-9dc1-daabd0f65a97, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:58:57,487 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: ff04bc65-7cf2-4d41-9dc1-daabd0f65a97, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:58:57,487 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: ff04bc65-7cf2-4d41-9dc1-daabd0f65a97, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:59:06,384 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-CCD5F7D11D2B->e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97, cid=87, seq=1*, RW, cmdType: WriteChunk
traceID: "495e08ae3530c078:495e08ae3530c078:0:0"
containerID: 21
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 21
    localID: 102892668862857238
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892668862857238_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: ff04bc65-7cf2-4d41-9dc1-daabd0f65a97, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:59:06,413 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-11F5B58B45A4:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-11F5B58B45A4:java.util.concurrent.CompletableFuture@b800054[Not completed]
2019-10-02 11:59:06,415 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-11F5B58B45A4:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:59:06,419 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:59:06,419 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:59:06,419 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:59:06,419 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:59:06,419 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:59:06,420 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:59:06,420 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:59:06,420 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:59:06,420 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/6ff34d87-4456-4a35-828f-11f5b58b45a4 does not exist. Creating ...
2019-10-02 11:59:06,446 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/6ff34d87-4456-4a35-828f-11f5b58b45a4/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:59:06,459 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/6ff34d87-4456-4a35-828f-11f5b58b45a4 has been successfully formatted.
2019-10-02 11:59:06,460 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-11F5B58B45A4: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:59:06,460 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:59:06,460 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:59:06,460 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:59:06,461 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:59:06,461 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:06,461 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:59:06,461 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/6ff34d87-4456-4a35-828f-11f5b58b45a4
2019-10-02 11:59:06,461 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:59:06,461 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:59:06,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:06,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:59:06,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:59:06,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:59:06,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:59:06,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:59:06,462 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:59:06,463 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:59:06,463 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:59:06,463 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:59:06,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:59:06,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:59:06,464 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:59:06,467 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:59:06,467 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:59:06,467 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:59:06,468 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-11F5B58B45A4,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:06,474 [IPC Server handler 0 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 6ff34d87-4456-4a35-828f-11f5b58b45a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:59:07,494 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:59:07,495 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: shutdown
2019-10-02 11:59:07,495 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DAABD0F65A97,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:07,495 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:59:07,496 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-PendingRequests: sendNotLeaderResponses
2019-10-02 11:59:07,498 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:59:07,501 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97: closes. applyIndex: 0
2019-10-02 11:59:07,502 [e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:59:07,503 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-DAABD0F65A97-SegmentedRaftLogWorker close()
2019-10-02 11:59:07,510 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: ff04bc65-7cf2-4d41-9dc1-daabd0f65a97, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:59:11,498 [Thread-543] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-FollowerState: change to CANDIDATE, lastRpcTime:5030ms, electionTimeout:5030ms
2019-10-02 11:59:11,498 [Thread-543] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:59:11,498 [Thread-543] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:59:11,498 [Thread-543] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:59:11,512 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:59:11,512 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:59:11,513 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:59:11,513 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5052ms
2019-10-02 11:59:11,513 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:59:11,513 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:59:11,513 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:59:11,513 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:59:11,514 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:59:11,514 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:59:11,516 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:59:11,517 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:59:11,518 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-LeaderElection25] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:59:11,561 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/6ff34d87-4456-4a35-828f-11f5b58b45a4/current/log_inprogress_0
2019-10-02 11:59:13,654 [pool-26-thread-22] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:59:13,654 [pool-26-thread-22] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: caa6ce51d1b2105c:caa6ce51d1b2105c:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:59:13,679 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #22 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:59:13,679 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #22
11:59:13.678 [pool-26-thread-22] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 22 locID: 102892669925851159 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:59:13,679 [pool-26-thread-22] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-11F5B58B45A4: writeChunk writeStateMachineData failed: blockIdcontainerID: 22
localID: 102892669925851159
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892669925851159_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:59:13,680 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=6ff34d87-4456-4a35-828f-11f5b58b45a4.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:59:13,680 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 6ff34d87-4456-4a35-828f-11f5b58b45a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:59:13,680 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 6ff34d87-4456-4a35-828f-11f5b58b45a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:59:13,680 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 6ff34d87-4456-4a35-828f-11f5b58b45a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:59:22,599 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-C80625C3ADDE->e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4, cid=91, seq=1*, RW, cmdType: WriteChunk
traceID: "caa6ce51d1b2105c:caa6ce51d1b2105c:0:0"
containerID: 22
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 22
    localID: 102892669925851159
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892669925851159_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 6ff34d87-4456-4a35-828f-11f5b58b45a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:59:22,633 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-435EBE795BC1:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-435EBE795BC1:java.util.concurrent.CompletableFuture@22d0635d[Not completed]
2019-10-02 11:59:22,635 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-435EBE795BC1:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:59:22,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:59:22,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:59:22,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:59:22,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:59:22,636 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:59:22,636 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:59:22,637 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:59:22,637 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:59:22,637 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c6f262c0-524d-4fa5-8fdb-435ebe795bc1 does not exist. Creating ...
2019-10-02 11:59:22,651 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c6f262c0-524d-4fa5-8fdb-435ebe795bc1/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:59:22,666 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c6f262c0-524d-4fa5-8fdb-435ebe795bc1 has been successfully formatted.
2019-10-02 11:59:22,666 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-435EBE795BC1: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:59:22,666 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:59:22,666 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:59:22,666 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:59:22,667 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:59:22,667 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:22,667 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:59:22,667 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c6f262c0-524d-4fa5-8fdb-435ebe795bc1
2019-10-02 11:59:22,667 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:59:22,667 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:59:22,667 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:22,668 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:59:22,668 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:59:22,668 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:59:22,668 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:59:22,668 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:59:22,668 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:59:22,669 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:59:22,669 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:59:22,669 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:59:22,669 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:59:22,669 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:59:22,670 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:59:22,672 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:59:22,672 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:59:22,672 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:59:22,673 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-435EBE795BC1,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:22,678 [IPC Server handler 2 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: c6f262c0-524d-4fa5-8fdb-435ebe795bc1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:59:23,688 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:59:23,688 [grpc-default-executor-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: shutdown
2019-10-02 11:59:23,689 [grpc-default-executor-1] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-11F5B58B45A4,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:23,689 [grpc-default-executor-1] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:59:23,689 [grpc-default-executor-1] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-PendingRequests: sendNotLeaderResponses
2019-10-02 11:59:23,691 [grpc-default-executor-1] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:59:23,693 [grpc-default-executor-1] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4: closes. applyIndex: 0
2019-10-02 11:59:23,694 [e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:59:23,697 [grpc-default-executor-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-11F5B58B45A4-SegmentedRaftLogWorker close()
2019-10-02 11:59:23,707 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 6ff34d87-4456-4a35-828f-11f5b58b45a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:59:27,820 [Thread-561] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-FollowerState: change to CANDIDATE, lastRpcTime:5147ms, electionTimeout:5147ms
2019-10-02 11:59:27,821 [Thread-561] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:59:27,821 [Thread-561] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:59:27,821 [Thread-561] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:59:27,836 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:59:27,836 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:59:27,836 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:59:27,836 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5170ms
2019-10-02 11:59:27,837 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:59:27,837 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:59:27,837 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:59:27,837 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:59:27,837 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:59:27,837 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:59:27,840 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:59:27,840 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:59:27,841 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-LeaderElection26] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:59:27,878 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/c6f262c0-524d-4fa5-8fdb-435ebe795bc1/current/log_inprogress_0
2019-10-02 11:59:29,877 [pool-26-thread-23] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 159
2019-10-02 11:59:29,878 [pool-26-thread-23] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 1820a4746b8ce69:1820a4746b8ce69:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 159 : Result: INVALID_WRITE_SIZE
2019-10-02 11:59:29,878 [EventQueue-ContainerReportForContainerReportHandler] ERROR events.SingleThreadExecutor (SingleThreadExecutor.java:lambda$onMessage$1(88)) - Error on execution message org.apache.hadoop.hdds.scm.server.SCMDatanodeHeartbeatDispatcher$ContainerReportFromDatanode@7395a711
java.util.ConcurrentModificationException
	at java.util.HashMap$HashIterator.nextNode(HashMap.java:1445)
	at java.util.HashMap$KeyIterator.next(HashMap.java:1469)
	at java.util.Collections$UnmodifiableCollection$1.next(Collections.java:1042)
	at java.util.AbstractCollection.addAll(AbstractCollection.java:343)
	at java.util.HashSet.<init>(HashSet.java:120)
	at org.apache.hadoop.hdds.scm.container.ContainerReportHandler.onMessage(ContainerReportHandler.java:94)
	at org.apache.hadoop.hdds.scm.container.ContainerReportHandler.onMessage(ContainerReportHandler.java:46)
	at org.apache.hadoop.hdds.server.events.SingleThreadExecutor.lambda$onMessage$1(SingleThreadExecutor.java:85)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2019-10-02 11:59:29,891 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #23 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
11:59:29.891 [pool-26-thread-23] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 23 locID: 102892670987730968 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 159
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:59:29,892 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #23
2019-10-02 11:59:29,892 [pool-26-thread-23] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-435EBE795BC1: writeChunk writeStateMachineData failed: blockIdcontainerID: 23
localID: 102892670987730968
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892670987730968_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 159 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:59:29,892 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=c6f262c0-524d-4fa5-8fdb-435ebe795bc1.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 159
2019-10-02 11:59:29,893 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: c6f262c0-524d-4fa5-8fdb-435ebe795bc1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 159
2019-10-02 11:59:29,893 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: c6f262c0-524d-4fa5-8fdb-435ebe795bc1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:59:29,893 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: c6f262c0-524d-4fa5-8fdb-435ebe795bc1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:59:38,798 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-57C73BEB1A7F->e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1, cid=95, seq=1*, RW, cmdType: WriteChunk
traceID: "1820a4746b8ce69:1820a4746b8ce69:0:0"
containerID: 23
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 23
    localID: 102892670987730968
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892670987730968_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: c6f262c0-524d-4fa5-8fdb-435ebe795bc1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:59:38,832 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-C638E47416A4:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-C638E47416A4:java.util.concurrent.CompletableFuture@3ca43ce3[Not completed]
2019-10-02 11:59:38,834 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-C638E47416A4:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:59:38,835 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:59:38,835 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:59:38,835 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:59:38,835 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:59:38,835 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:59:38,836 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:59:38,836 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:59:38,836 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:59:38,837 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/100e1dbc-6611-4a99-a4cb-c638e47416a4 does not exist. Creating ...
2019-10-02 11:59:38,863 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/100e1dbc-6611-4a99-a4cb-c638e47416a4/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:59:38,876 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/100e1dbc-6611-4a99-a4cb-c638e47416a4 has been successfully formatted.
2019-10-02 11:59:38,876 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-C638E47416A4: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:59:38,876 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:59:38,876 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:59:38,877 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:59:38,877 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:59:38,877 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:38,877 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:59:38,877 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/100e1dbc-6611-4a99-a4cb-c638e47416a4
2019-10-02 11:59:38,877 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:59:38,878 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:59:38,879 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:59:38,879 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:59:38,879 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:59:38,880 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:59:38,880 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:59:38,880 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:59:38,883 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:59:38,883 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:59:38,883 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:59:38,883 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C638E47416A4,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:38,890 [IPC Server handler 15 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 100e1dbc-6611-4a99-a4cb-c638e47416a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:59:39,900 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:59:39,900 [grpc-default-executor-3] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: shutdown
2019-10-02 11:59:39,901 [grpc-default-executor-3] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-435EBE795BC1,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:39,901 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:59:39,901 [grpc-default-executor-3] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-PendingRequests: sendNotLeaderResponses
2019-10-02 11:59:39,903 [grpc-default-executor-3] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:59:39,907 [grpc-default-executor-3] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1: closes. applyIndex: 0
2019-10-02 11:59:39,908 [e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:59:39,908 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-435EBE795BC1-SegmentedRaftLogWorker close()
2019-10-02 11:59:39,915 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: c6f262c0-524d-4fa5-8fdb-435ebe795bc1, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 11:59:44,012 [Thread-580] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-FollowerState: change to CANDIDATE, lastRpcTime:5129ms, electionTimeout:5129ms
2019-10-02 11:59:44,014 [Thread-580] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 11:59:44,014 [Thread-580] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 11:59:44,014 [Thread-580] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 11:59:44,069 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:59:44,070 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 11:59:44,070 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 11:59:44,070 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5193ms
2019-10-02 11:59:44,070 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 11:59:44,070 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 11:59:44,071 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 11:59:44,071 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 11:59:44,071 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 11:59:44,071 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 11:59:44,075 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 11:59:44,076 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 11:59:44,077 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-LeaderElection27] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 11:59:44,123 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/100e1dbc-6611-4a99-a4cb-c638e47416a4/current/log_inprogress_0
2019-10-02 11:59:46,080 [pool-26-thread-24] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:59:46,081 [pool-26-thread-24] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 93630aaecf912689:93630aaecf912689:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 11:59:46,107 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #24 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 11:59:46,107 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #24
11:59:46.106 [pool-26-thread-24] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 24 locID: 102892672050200601 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 11:59:46,107 [pool-26-thread-24] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-C638E47416A4: writeChunk writeStateMachineData failed: blockIdcontainerID: 24
localID: 102892672050200601
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892672050200601_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 11:59:46,107 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=100e1dbc-6611-4a99-a4cb-c638e47416a4.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:59:46,108 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 100e1dbc-6611-4a99-a4cb-c638e47416a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 11:59:46,108 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 100e1dbc-6611-4a99-a4cb-c638e47416a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:59:46,108 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 100e1dbc-6611-4a99-a4cb-c638e47416a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 11:59:55,002 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-E89596D1C617->e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4, cid=99, seq=1*, RW, cmdType: WriteChunk
traceID: "93630aaecf912689:93630aaecf912689:0:0"
containerID: 24
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 24
    localID: 102892672050200601
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892672050200601_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 100e1dbc-6611-4a99-a4cb-c638e47416a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 11:59:55,039 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-FC4B9E908F0E:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-FC4B9E908F0E:java.util.concurrent.CompletableFuture@69f8dc95[Not completed]
2019-10-02 11:59:55,041 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-FC4B9E908F0E:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 11:59:55,042 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 11:59:55,042 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 11:59:55,042 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 11:59:55,042 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 11:59:55,042 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 11:59:55,042 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 11:59:55,042 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 11:59:55,043 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 11:59:55,043 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/0185eeff-113f-40ab-b278-fc4b9e908f0e does not exist. Creating ...
2019-10-02 11:59:55,068 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/0185eeff-113f-40ab-b278-fc4b9e908f0e/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 11:59:55,081 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/0185eeff-113f-40ab-b278-fc4b9e908f0e has been successfully formatted.
2019-10-02 11:59:55,081 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-FC4B9E908F0E: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 11:59:55,082 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 11:59:55,082 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 11:59:55,082 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 11:59:55,082 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 11:59:55,082 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:55,083 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 11:59:55,083 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/0185eeff-113f-40ab-b278-fc4b9e908f0e
2019-10-02 11:59:55,083 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 11:59:55,083 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 11:59:55,083 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 11:59:55,084 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 11:59:55,084 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 11:59:55,084 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 11:59:55,084 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 11:59:55,084 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 11:59:55,084 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 11:59:55,085 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 11:59:55,085 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 11:59:55,086 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 11:59:55,086 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 11:59:55,086 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 11:59:55,086 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 11:59:55,090 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 11:59:55,090 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 11:59:55,090 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 11:59:55,091 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FC4B9E908F0E,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:55,097 [IPC Server handler 3 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 0185eeff-113f-40ab-b278-fc4b9e908f0e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 11:59:56,115 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 11:59:56,115 [grpc-default-executor-3] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: shutdown
2019-10-02 11:59:56,116 [grpc-default-executor-3] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C638E47416A4,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 11:59:56,116 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 11:59:56,116 [grpc-default-executor-3] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-PendingRequests: sendNotLeaderResponses
2019-10-02 11:59:56,119 [grpc-default-executor-3] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-StateMachineUpdater: set stopIndex = 0
2019-10-02 11:59:56,121 [grpc-default-executor-3] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4: closes. applyIndex: 0
2019-10-02 11:59:56,122 [e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 11:59:56,123 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-C638E47416A4-SegmentedRaftLogWorker close()
2019-10-02 11:59:56,134 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 100e1dbc-6611-4a99-a4cb-c638e47416a4, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 12:00:00,157 [Thread-598] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-FollowerState: change to CANDIDATE, lastRpcTime:5066ms, electionTimeout:5066ms
2019-10-02 12:00:00,158 [Thread-598] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 12:00:00,158 [Thread-598] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 12:00:00,159 [Thread-598] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 12:00:00,187 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 12:00:00,188 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 12:00:00,188 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 12:00:00,188 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5106ms
2019-10-02 12:00:00,188 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 12:00:00,188 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 12:00:00,189 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 12:00:00,189 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 12:00:00,189 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 12:00:00,189 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 12:00:00,193 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 12:00:00,193 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 12:00:00,194 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-LeaderElection28] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 12:00:00,239 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/0185eeff-113f-40ab-b278-fc4b9e908f0e/current/log_inprogress_0
2019-10-02 12:00:02,295 [pool-26-thread-25] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:02,296 [pool-26-thread-25] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 41cca6bb89bbbc9c:41cca6bb89bbbc9c:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
12:00:02.330 [pool-26-thread-25] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 25 locID: 102892673112277018 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 12:00:02,331 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #25 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 12:00:02,331 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #25
2019-10-02 12:00:02,331 [pool-26-thread-25] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-FC4B9E908F0E: writeChunk writeStateMachineData failed: blockIdcontainerID: 25
localID: 102892673112277018
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892673112277018_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 12:00:02,332 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=0185eeff-113f-40ab-b278-fc4b9e908f0e.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:02,332 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 0185eeff-113f-40ab-b278-fc4b9e908f0e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:02,332 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 0185eeff-113f-40ab-b278-fc4b9e908f0e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 12:00:02,333 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 0185eeff-113f-40ab-b278-fc4b9e908f0e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 12:00:11,274 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-BF7FC49CFDEE->e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E, cid=103, seq=1*, RW, cmdType: WriteChunk
traceID: "41cca6bb89bbbc9c:41cca6bb89bbbc9c:0:0"
containerID: 25
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 25
    localID: 102892673112277018
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892673112277018_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 0185eeff-113f-40ab-b278-fc4b9e908f0e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 12:00:11,308 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-2A2513994CBC:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-2A2513994CBC:java.util.concurrent.CompletableFuture@61ef1a1d[Not completed]
2019-10-02 12:00:11,311 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-2A2513994CBC:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 12:00:11,312 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 12:00:11,312 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 12:00:11,312 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 12:00:11,312 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 12:00:11,312 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 12:00:11,313 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 12:00:11,313 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 12:00:11,313 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 12:00:11,314 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/a82256c8-67d9-4312-99e1-2a2513994cbc does not exist. Creating ...
2019-10-02 12:00:11,341 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/a82256c8-67d9-4312-99e1-2a2513994cbc/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 12:00:11,355 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/a82256c8-67d9-4312-99e1-2a2513994cbc has been successfully formatted.
2019-10-02 12:00:11,355 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-2A2513994CBC: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 12:00:11,355 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 12:00:11,355 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 12:00:11,356 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 12:00:11,356 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 12:00:11,356 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 12:00:11,356 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 12:00:11,356 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/a82256c8-67d9-4312-99e1-2a2513994cbc
2019-10-02 12:00:11,357 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 12:00:11,357 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 12:00:11,357 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 12:00:11,357 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 12:00:11,357 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 12:00:11,357 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 12:00:11,358 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 12:00:11,358 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 12:00:11,358 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 12:00:11,358 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 12:00:11,359 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 12:00:11,359 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 12:00:11,359 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 12:00:11,359 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 12:00:11,360 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 12:00:11,362 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 12:00:11,363 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 12:00:11,363 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 12:00:11,363 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2A2513994CBC,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 12:00:11,370 [IPC Server handler 11 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: a82256c8-67d9-4312-99e1-2a2513994cbc, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 12:00:12,341 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 12:00:12,341 [grpc-default-executor-3] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: shutdown
2019-10-02 12:00:12,341 [grpc-default-executor-3] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FC4B9E908F0E,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 12:00:12,342 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 12:00:12,342 [grpc-default-executor-3] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-PendingRequests: sendNotLeaderResponses
2019-10-02 12:00:12,345 [grpc-default-executor-3] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-StateMachineUpdater: set stopIndex = 0
2019-10-02 12:00:12,346 [grpc-default-executor-3] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E: closes. applyIndex: 0
2019-10-02 12:00:12,348 [e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 12:00:12,350 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-FC4B9E908F0E-SegmentedRaftLogWorker close()
2019-10-02 12:00:12,359 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 0185eeff-113f-40ab-b278-fc4b9e908f0e, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 12:00:16,389 [Thread-616] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-FollowerState: change to CANDIDATE, lastRpcTime:5025ms, electionTimeout:5025ms
2019-10-02 12:00:16,389 [Thread-616] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 12:00:16,389 [Thread-616] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 12:00:16,389 [Thread-616] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 12:00:16,405 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 12:00:16,406 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 12:00:16,406 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 12:00:16,406 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5050ms
2019-10-02 12:00:16,406 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 12:00:16,406 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 12:00:16,406 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 12:00:16,407 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 12:00:16,407 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 12:00:16,407 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 12:00:16,416 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 12:00:16,417 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 12:00:16,417 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-LeaderElection29] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 12:00:16,465 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/a82256c8-67d9-4312-99e1-2a2513994cbc/current/log_inprogress_0
2019-10-02 12:00:18,533 [pool-26-thread-26] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:18,534 [pool-26-thread-26] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: d6522f75022d6332:d6522f75022d6332:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
12:00:18.547 [pool-26-thread-26] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 26 locID: 102892674178744347 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 12:00:18,548 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #26 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
2019-10-02 12:00:18,548 [pool-26-thread-26] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-2A2513994CBC: writeChunk writeStateMachineData failed: blockIdcontainerID: 26
localID: 102892674178744347
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892674178744347_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 12:00:18,548 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #26
2019-10-02 12:00:18,548 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=a82256c8-67d9-4312-99e1-2a2513994cbc.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:18,549 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: a82256c8-67d9-4312-99e1-2a2513994cbc, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:18,549 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: a82256c8-67d9-4312-99e1-2a2513994cbc, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 12:00:18,549 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: a82256c8-67d9-4312-99e1-2a2513994cbc, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 12:00:27,450 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-076DD2F65D11->e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC, cid=107, seq=1*, RW, cmdType: WriteChunk
traceID: "d6522f75022d6332:d6522f75022d6332:0:0"
containerID: 26
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 26
    localID: 102892674178744347
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892674178744347_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: a82256c8-67d9-4312-99e1-2a2513994cbc, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 12:00:27,485 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-480EBEF4D3C7:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-480EBEF4D3C7:java.util.concurrent.CompletableFuture@2bef16e4[Not completed]
2019-10-02 12:00:27,487 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-480EBEF4D3C7:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 12:00:27,488 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 12:00:27,488 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 12:00:27,488 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 12:00:27,489 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 12:00:27,489 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 12:00:27,489 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 12:00:27,489 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 12:00:27,489 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 12:00:27,490 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/634f648d-f88a-4a06-a46e-480ebef4d3c7 does not exist. Creating ...
2019-10-02 12:00:27,505 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/634f648d-f88a-4a06-a46e-480ebef4d3c7/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 12:00:27,518 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/634f648d-f88a-4a06-a46e-480ebef4d3c7 has been successfully formatted.
2019-10-02 12:00:27,518 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-480EBEF4D3C7: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 12:00:27,518 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 12:00:27,519 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 12:00:27,519 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 12:00:27,519 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 12:00:27,519 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 12:00:27,519 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 12:00:27,519 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/634f648d-f88a-4a06-a46e-480ebef4d3c7
2019-10-02 12:00:27,520 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 12:00:27,520 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 12:00:27,520 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 12:00:27,520 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 12:00:27,520 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 12:00:27,520 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 12:00:27,520 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 12:00:27,521 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 12:00:27,521 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 12:00:27,521 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 12:00:27,521 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 12:00:27,522 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 12:00:27,522 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 12:00:27,522 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 12:00:27,522 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 12:00:27,525 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 12:00:27,525 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 12:00:27,526 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 12:00:27,526 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-480EBEF4D3C7,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 12:00:27,534 [IPC Server handler 0 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 634f648d-f88a-4a06-a46e-480ebef4d3c7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 12:00:28,556 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 12:00:28,557 [grpc-default-executor-3] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: shutdown
2019-10-02 12:00:28,557 [grpc-default-executor-3] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2A2513994CBC,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 12:00:28,557 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 12:00:28,557 [grpc-default-executor-3] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-PendingRequests: sendNotLeaderResponses
2019-10-02 12:00:28,559 [grpc-default-executor-3] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-StateMachineUpdater: set stopIndex = 0
2019-10-02 12:00:28,564 [grpc-default-executor-3] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC: closes. applyIndex: 0
2019-10-02 12:00:28,565 [e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 12:00:28,566 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-2A2513994CBC-SegmentedRaftLogWorker close()
2019-10-02 12:00:28,574 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: a82256c8-67d9-4312-99e1-2a2513994cbc, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 12:00:32,704 [Thread-635] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-FollowerState: change to CANDIDATE, lastRpcTime:5178ms, electionTimeout:5178ms
2019-10-02 12:00:32,705 [Thread-635] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 12:00:32,705 [Thread-635] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 12:00:32,705 [Thread-635] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 12:00:32,720 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 12:00:32,721 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 12:00:32,721 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 12:00:32,721 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5202ms
2019-10-02 12:00:32,721 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 12:00:32,721 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 12:00:32,721 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 12:00:32,721 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 12:00:32,722 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 12:00:32,722 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 12:00:32,724 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 12:00:32,725 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 12:00:32,725 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-LeaderElection30] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 12:00:32,775 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/634f648d-f88a-4a06-a46e-480ebef4d3c7/current/log_inprogress_0
2019-10-02 12:00:34,732 [pool-26-thread-27] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:34,733 [pool-26-thread-27] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: 9dace3627d0f6f64:9dace3627d0f6f64:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 12:00:34,747 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #27 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
12:00:34.747 [pool-26-thread-27] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 27 locID: 102892675238133788 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 12:00:34,747 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #27
2019-10-02 12:00:34,748 [pool-26-thread-27] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-480EBEF4D3C7: writeChunk writeStateMachineData failed: blockIdcontainerID: 27
localID: 102892675238133788
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892675238133788_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 12:00:34,748 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=634f648d-f88a-4a06-a46e-480ebef4d3c7.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:34,749 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 634f648d-f88a-4a06-a46e-480ebef4d3c7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:34,749 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 634f648d-f88a-4a06-a46e-480ebef4d3c7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 12:00:34,749 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 634f648d-f88a-4a06-a46e-480ebef4d3c7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 12:00:43,665 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-006B65F1D949->e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7, cid=111, seq=1*, RW, cmdType: WriteChunk
traceID: "9dace3627d0f6f64:9dace3627d0f6f64:0:0"
containerID: 27
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 27
    localID: 102892675238133788
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892675238133788_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 634f648d-f88a-4a06-a46e-480ebef4d3c7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 12:00:43,695 [grpc-default-executor-4] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-90D6C40A5D46:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-90D6C40A5D46:java.util.concurrent.CompletableFuture@242851b4[Not completed]
2019-10-02 12:00:43,698 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-90D6C40A5D46:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 12:00:43,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 12:00:43,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 12:00:43,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 12:00:43,699 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 12:00:43,700 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 12:00:43,700 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 12:00:43,700 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 12:00:43,701 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 12:00:43,701 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/59761c6b-5fcd-495b-bff4-90d6c40a5d46 does not exist. Creating ...
2019-10-02 12:00:43,726 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/59761c6b-5fcd-495b-bff4-90d6c40a5d46/in_use.lock acquired by nodename 23833@pr-trunk-gg4kw-413187789
2019-10-02 12:00:43,749 [pool-27-thread-1] INFO  storage.RaftStorage (RaftStorage.java:format(84)) - Storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/59761c6b-5fcd-495b-bff4-90d6c40a5d46 has been successfully formatted.
2019-10-02 12:00:43,749 [pool-27-thread-1] INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(231)) - group-90D6C40A5D46: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
2019-10-02 12:00:43,749 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.notification.no-leader.timeout = 120s (custom)
2019-10-02 12:00:43,750 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-10-02 12:00:43,750 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000 (custom)
2019-10-02 12:00:43,750 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-10-02 12:00:43,750 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 12:00:43,751 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-10-02 12:00:43,751 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(173)) - new e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker for RaftStorage:Storage Directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/59761c6b-5fcd-495b-bff4-90d6c40a5d46
2019-10-02 12:00:43,751 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-10-02 12:00:43,751 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-10-02 12:00:43,751 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-10-02 12:00:43,751 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-10-02 12:00:43,752 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-10-02 12:00:43,752 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-10-02 12:00:43,752 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-10-02 12:00:43,752 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-10-02 12:00:43,752 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-10-02 12:00:43,753 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-10-02 12:00:43,753 [pool-27-thread-1] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(128)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
2019-10-02 12:00:43,754 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-10-02 12:00:43,754 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 1 (custom)
2019-10-02 12:00:43,754 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.retention.file.num = 5 (custom)
2019-10-02 12:00:43,754 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-10-02 12:00:43,757 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:start(181)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: start as a follower, conf=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 12:00:43,757 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: changes role from      null to FOLLOWER at term 0 for startAsFollower
2019-10-02 12:00:43,757 [pool-27-thread-1] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start FollowerState
2019-10-02 12:00:43,758 [pool-27-thread-1] INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-90D6C40A5D46,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 12:00:43,765 [IPC Server handler 2 on 33744] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 59761c6b-5fcd-495b-bff4-90d6c40a5d46, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 12:00:44,756 [grpc-default-executor-4] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 12:00:44,757 [grpc-default-executor-4] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: shutdown
2019-10-02 12:00:44,757 [grpc-default-executor-4] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-480EBEF4D3C7,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 12:00:44,757 [grpc-default-executor-4] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 12:00:44,757 [grpc-default-executor-4] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-PendingRequests: sendNotLeaderResponses
2019-10-02 12:00:44,759 [grpc-default-executor-4] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-StateMachineUpdater: set stopIndex = 0
2019-10-02 12:00:44,761 [grpc-default-executor-4] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7: closes. applyIndex: 0
2019-10-02 12:00:44,762 [e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 12:00:44,764 [grpc-default-executor-4] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-480EBEF4D3C7-SegmentedRaftLogWorker close()
2019-10-02 12:00:44,773 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 634f648d-f88a-4a06-a46e-480ebef4d3c7, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 12:00:48,846 [Thread-653] INFO  impl.FollowerState (FollowerState.java:run(108)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-FollowerState: change to CANDIDATE, lastRpcTime:5088ms, electionTimeout:5088ms
2019-10-02 12:00:48,847 [Thread-653] INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown FollowerState
2019-10-02 12:00:48,847 [Thread-653] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-10-02 12:00:48,847 [Thread-653] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderElection
2019-10-02 12:00:48,863 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  impl.LeaderElection (LeaderElection.java:askForVotes(178)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31: begin an election at term 1 for -1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null
2019-10-02 12:00:48,863 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderElection
2019-10-02 12:00:48,864 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(170)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-10-02 12:00:48,864 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  impl.RaftServerImpl (ServerState.java:setLeader(255)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: change Leader from null to e5813bca-be1b-4833-8967-802e28d44868 at term 1 for becomeLeader, leader elected after 5114ms
2019-10-02 12:00:48,864 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-10-02 12:00:48,864 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-10-02 12:00:48,865 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-10-02 12:00:48,865 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-10-02 12:00:48,865 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-10-02 12:00:48,865 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-10-02 12:00:48,870 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5813bca-be1b-4833-8967-802e28d44868: start LeaderState
2019-10-02 12:00:48,870 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(385)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker: Starting segment from index:0
2019-10-02 12:00:48,871 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-LeaderElection31] INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(356)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: set configuration 0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null at 0
2019-10-02 12:00:48,912 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(574)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker: created new log segment /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/59761c6b-5fcd-495b-bff4-90d6c40a5d46/current/log_inprogress_0
2019-10-02 12:00:50,937 [pool-26-thread-28] ERROR impl.ChunkManagerImpl (ChunkUtils.java:writeData(89)) - data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:50,937 [pool-26-thread-28] INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: WriteChunk : Trace ID: bef20ba466d10768:bef20ba466d10768:0:0 : Message: data array does not match the length specified. DataLen: 5 Byte Array: 161 : Result: INVALID_WRITE_SIZE
2019-10-02 12:00:50,952 [EventQueue-IncrementalContainerReportForIncrementalContainerReportHandler] WARN  container.IncrementalContainerReportHandler (AbstractContainerReportHandler.java:updateContainerState(143)) - Container #28 is in OPEN state, but the datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null} reports an UNHEALTHY replica.
12:00:50.951 [pool-26-thread-28] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 28 locID: 102892676301783069 bcsId: 0} | ret=FAILURE
java.lang.Exception: data array does not match the length specified. DataLen: 5 Byte Array: 161
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:330) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:150) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.dispatchCommand(ContainerStateMachine.java:411) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.runCommand(ContainerStateMachine.java:419) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.lambda$handleWriteChunk$1(ContainerStateMachine.java:454) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-10-02 12:00:50,952 [EventQueue-CloseContainerForCloseContainerEventHandler] INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #28
2019-10-02 12:00:50,952 [pool-26-thread-28] ERROR ratis.ContainerStateMachine (ContainerStateMachine.java:lambda$handleWriteChunk$2(474)) - group-90D6C40A5D46: writeChunk writeStateMachineData failed: blockIdcontainerID: 28
localID: 102892676301783069
blockCommitSequenceId: 0
 logIndex 1 chunkName 102892676301783069_chunk_1 Error message: data array does not match the length specified. DataLen: 5 Byte Array: 161 Container Result: INVALID_WRITE_SIZE
2019-10-02 12:00:50,952 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker] ERROR ratis.XceiverServerRatis (XceiverServerRatis.java:triggerPipelineClose(581)) - pipeline Action CLOSE  on pipeline PipelineID=59761c6b-5fcd-495b-bff4-90d6c40a5d46.Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:50,953 [EventQueue-PipelineActionsForPipelineActionHandler] ERROR pipeline.PipelineActionHandler (PipelineActionHandler.java:onMessage(60)) - Received pipeline action CLOSE for Pipeline[ Id: 59761c6b-5fcd-495b-bff4-90d6c40a5d46, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN] from datanode e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}. Reason : data array does not match the length specified. DataLen: 5 Byte Array: 161
2019-10-02 12:00:50,953 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(315)) - destroying pipeline:Pipeline[ Id: 59761c6b-5fcd-495b-bff4-90d6c40a5d46, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-10-02 12:00:50,953 [EventQueue-PipelineActionsForPipelineActionHandler] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 59761c6b-5fcd-495b-bff4-90d6c40a5d46, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-10-02 12:00:59,857 [main] WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(274)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-8EACD568B24F->e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46, cid=115, seq=1*, RW, cmdType: WriteChunk
traceID: "bef20ba466d10768:bef20ba466d10768:0:0"
containerID: 28
datanodeUuid: "e5813bca-be1b-4833-8967-802e28d44868"
writeChunk {
  blockID {
    containerID: 28
    localID: 102892676301783069
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "102892676301783069_chunk_1"
    offset: 0
    len: 5
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\000\000\000\000\350a\3440"
    }
  }
}
, data.size=5 for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms) on the pipeline Pipeline[ Id: 59761c6b-5fcd-495b-bff4-90d6c40a5d46, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]. The last committed block length is 0, uncommitted data length is 5 retry count 0
2019-10-02 12:00:59,887 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-1F63A26DA885:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-1F63A26DA885:java.util.concurrent.CompletableFuture@7a7d2cd6[Not completed]
2019-10-02 12:00:59,890 [pool-27-thread-1] INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(95)) - e5813bca-be1b-4833-8967-802e28d44868: new RaftServerImpl for group-1F63A26DA885:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] with ContainerStateMachine:uninitialized
2019-10-02 12:00:59,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 5s (custom)
2019-10-02 12:00:59,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 5200ms (custom)
2019-10-02 12:00:59,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-10-02 12:00:59,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-10-02 12:00:59,891 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-10-02 12:00:59,892 [pool-27-thread-1] INFO  impl.RaftServerImpl (ServerState.java:<init>(103)) - e5813bca-be1b-4833-8967-802e28d44868@group-1F63A26DA885: ConfigurationManager, init=-1: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null, confs=<EMPTY_MAP>
2019-10-02 12:00:59,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis] (custom)
2019-10-02 12:00:59,892 [pool-27-thread-1] INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.corruption.policy = EXCEPTION (default)
2019-10-02 12:00:59,892 [pool-27-thread-1] INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /workdir/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-556dca40-8b2b-4251-8685-c8ba1aa1becd/datanode-0/data/ratis/6f529dcc-77a8-47b6-ab84-1f63a26da885 does not exist. Creating ...
2019-10-02 12:01:00,966 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - e5813bca-be1b-4833-8967-802e28d44868: remove    LEADER e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46:t1, leader=e5813bca-be1b-4833-8967-802e28d44868, voted=e5813bca-be1b-4833-8967-802e28d44868, raftlog=e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLog:OPENED:c0,f0,i1, conf=0: [e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529], old=null RUNNING
2019-10-02 12:01:00,967 [grpc-default-executor-3] INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(247)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: shutdown
2019-10-02 12:01:00,968 [grpc-default-executor-3] INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-90D6C40A5D46,id=e5813bca-be1b-4833-8967-802e28d44868
2019-10-02 12:01:00,968 [grpc-default-executor-3] INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5813bca-be1b-4833-8967-802e28d44868: shutdown LeaderState
2019-10-02 12:01:00,968 [grpc-default-executor-3] INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-PendingRequests: sendNotLeaderResponses
2019-10-02 12:01:00,971 [grpc-default-executor-3] INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(136)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-StateMachineUpdater: set stopIndex = 0
2019-10-02 12:01:00,974 [grpc-default-executor-3] INFO  impl.RaftServerImpl (ServerState.java:close(387)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46: closes. applyIndex: 0
2019-10-02 12:01:00,975 [e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(316)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-10-02 12:01:00,977 [grpc-default-executor-3] INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(224)) - e5813bca-be1b-4833-8967-802e28d44868@group-90D6C40A5D46-SegmentedRaftLogWorker close()
2019-10-02 12:01:02,882 [RATISCREATEPIPELINE1] ERROR pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$null$5(235)) - Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@3a2eec65 for e5813bca-be1b-4833-8967-802e28d44868
org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2998559128ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2998559128ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 12:01:02,885 [IPC Server handler 15 on 33744] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(192)) - Pipeline creation failed for type:RATIS factor:ONE. Retrying get pipelines call once.
java.io.IOException: Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@3a2eec65 for e5813bca-be1b-4833-8967-802e28d44868
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:236)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2998559128ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	... 19 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2998559128ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 12:01:02,885 [RatisPipelineUtilsThread] INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 59761c6b-5fcd-495b-bff4-90d6c40a5d46, Nodes: e5813bca-be1b-4833-8967-802e28d44868{ip: 192.168.151.92, host: pr-trunk-gg4kw-413187789, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] removed from db
2019-10-02 12:01:02,887 [IPC Server handler 15 on 33744] INFO  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(198)) - Could not find available pipeline of type:RATIS and factor:ONE even after retrying
2019-10-02 12:01:02,887 [IPC Server handler 15 on 33744] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(222)) - Unable to allocate a block for the size: 4194304, type: RATIS, factor: ONE
2019-10-02 12:01:02,890 [main] ERROR io.BlockOutputStreamEntryPool (BlockOutputStreamEntryPool.java:allocateBlockIfNeeded(299)) - Try to allocate more blocks for write failed, already allocated 0 blocks for this write.
INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocated 0 blocks. Requested 1 blocks
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:732)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.allocateBlock(OzoneManagerProtocolClientSideTranslatorPB.java:764)
	at sun.reflect.GeneratedMethodAccessor179.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66)
	at com.sun.proxy.$Proxy37.allocateBlock(Unknown Source)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateNewBlock(BlockOutputStreamEntryPool.java:248)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateBlockIfNeeded(BlockOutputStreamEntryPool.java:296)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:198)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleRetry(KeyOutputStream.java:375)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleException(KeyOutputStream.java:324)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleFlushOrClose(KeyOutputStream.java:449)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.flush(KeyOutputStream.java:397)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.flush(OzoneOutputStream.java:54)
	at org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures.testContainerStateMachineFailures(TestContainerStateMachineFailures.java:158)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
]]></system-out>
  </testcase>
  <testcase name="testUnhealthyContainer" classname="org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures" time="6.021">
    <error message="Allocated 0 blocks. Requested 1 blocks" type="INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException">INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocated 0 blocks. Requested 1 blocks
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:732)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.openKey(OzoneManagerProtocolClientSideTranslatorPB.java:723)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66)
	at com.sun.proxy.$Proxy37.openKey(Unknown Source)
	at org.apache.hadoop.ozone.client.rpc.RpcClient.createKey(RpcClient.java:614)
	at org.apache.hadoop.ozone.client.OzoneBucket.createKey(OzoneBucket.java:325)
	at org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures.testUnhealthyContainer(TestContainerStateMachineFailures.java:207)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
</error>
    <system-out><![CDATA[2019-10-02 12:01:02,896 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-CEB9EF6C49EC:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-CEB9EF6C49EC:java.util.concurrent.CompletableFuture@1fcdf688[Not completed]
2019-10-02 12:01:05,894 [RATISCREATEPIPELINE1] ERROR pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$null$5(235)) - Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@5e5d227 for e5813bca-be1b-4833-8967-802e28d44868
org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999045728ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999045728ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 12:01:05,904 [grpc-default-executor-3] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-202BEE0D2E6F:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-202BEE0D2E6F:java.util.concurrent.CompletableFuture@b531059[Not completed]
2019-10-02 12:01:08,905 [RATISCREATEPIPELINE1] ERROR pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$null$5(235)) - Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@3eb52772 for e5813bca-be1b-4833-8967-802e28d44868
org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999813343ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999813343ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 12:01:08,907 [IPC Server handler 3 on 33744] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(192)) - Pipeline creation failed for type:RATIS factor:ONE. Retrying get pipelines call once.
java.io.IOException: Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@3eb52772 for e5813bca-be1b-4833-8967-802e28d44868
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:236)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999813343ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	... 19 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999813343ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 12:01:08,909 [IPC Server handler 3 on 33744] INFO  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(198)) - Could not find available pipeline of type:RATIS and factor:ONE even after retrying
2019-10-02 12:01:08,909 [IPC Server handler 3 on 33744] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(222)) - Unable to allocate a block for the size: 4194304, type: RATIS, factor: ONE
]]></system-out>
  </testcase>
  <testcase name="testApplyTransactionFailure" classname="org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures" time="3.024">
    <error message="Allocated 0 blocks. Requested 1 blocks" type="INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException">INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocated 0 blocks. Requested 1 blocks
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:732)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.openKey(OzoneManagerProtocolClientSideTranslatorPB.java:723)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66)
	at com.sun.proxy.$Proxy37.openKey(Unknown Source)
	at org.apache.hadoop.ozone.client.rpc.RpcClient.createKey(RpcClient.java:614)
	at org.apache.hadoop.ozone.client.OzoneBucket.createKey(OzoneBucket.java:325)
	at org.apache.hadoop.ozone.client.rpc.TestContainerStateMachineFailures.testApplyTransactionFailure(TestContainerStateMachineFailures.java:281)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
</error>
    <system-out><![CDATA[2019-10-02 12:01:08,930 [grpc-default-executor-1] INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5813bca-be1b-4833-8967-802e28d44868: addNew group-B399BC859C4C:[e5813bca-be1b-4833-8967-802e28d44868:192.168.151.92:34529] returns group-B399BC859C4C:java.util.concurrent.CompletableFuture@7e7838de[Not completed]
2019-10-02 12:01:11,931 [RATISCREATEPIPELINE1] ERROR pipeline.RatisPipelineProvider (RatisPipelineProvider.java:lambda$null$5(235)) - Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@57b9500 for e5813bca-be1b-4833-8967-802e28d44868
org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999756129ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999756129ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 12:01:11,933 [IPC Server handler 10 on 33744] WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(192)) - Pipeline creation failed for type:RATIS factor:ONE. Retrying get pipelines call once.
java.io.IOException: Failed invoke Ratis rpc org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider$$Lambda$176/473899717@57b9500 for e5813bca-be1b-4833-8967-802e28d44868
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:236)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.ForEachOps$ForEachTask.compute(ForEachOps.java:291)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ForEachOps$ForEachOp.evaluateParallel(ForEachOps.java:160)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateParallel(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:583)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$callRatisRpc$6(RatisPipelineProvider.java:225)
	at java.util.concurrent.ForkJoinTask$AdaptedRunnableAction.exec(ForkJoinTask.java:1386)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
Caused by: org.apache.ratis.protocol.TimeoutIOException: deadline exceeded after 2999756129ns
	at org.apache.ratis.grpc.GrpcUtil.tryUnwrapException(GrpcUtil.java:82)
	at org.apache.ratis.grpc.GrpcUtil.unwrapException(GrpcUtil.java:75)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:184)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.groupAdd(GrpcClientProtocolClient.java:153)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:94)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:278)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:205)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$initializePipeline$4(RatisPipelineProvider.java:196)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.lambda$null$5(RatisPipelineProvider.java:231)
	... 19 more
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: DEADLINE_EXCEEDED: deadline exceeded after 2999756129ns
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.AdminProtocolServiceGrpc$AdminProtocolServiceBlockingStub.groupManagement(AdminProtocolServiceGrpc.java:274)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.lambda$groupAdd$3(GrpcClientProtocolClient.java:155)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.blockingCall(GrpcClientProtocolClient.java:182)
	... 25 more
2019-10-02 12:01:11,934 [IPC Server handler 10 on 33744] INFO  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(198)) - Could not find available pipeline of type:RATIS and factor:ONE even after retrying
2019-10-02 12:01:11,935 [IPC Server handler 10 on 33744] ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(222)) - Unable to allocate a block for the size: 4194304, type: RATIS, factor: ONE
]]></system-out>
  </testcase>
</testsuite>
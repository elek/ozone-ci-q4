-------------------------------------------------------------------------------
Test set: org.apache.hadoop.ozone.container.common.transport.server.ratis.TestCSMMetrics
-------------------------------------------------------------------------------
Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 183.393 s <<< FAILURE! - in org.apache.hadoop.ozone.container.common.transport.server.ratis.TestCSMMetrics
testContainerStateMachineMetrics(org.apache.hadoop.ozone.container.common.transport.server.ratis.TestCSMMetrics)  Time elapsed: 183.33 s  <<< ERROR!
java.io.IOException: 
Failed to command cmdType: WriteChunk
containerID: 1571646715189
datanodeUuid: "a7326c16-2bb8-4407-aeed-aa800b5e9183"
writeChunk {
  blockID {
    containerID: 1571646715189
    localID: 1571646715191
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "1571646715191.data.0"
    offset: 0
    len: 1024
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\025\317\362\255"
    }
  }
  data: "\220\212\370\301\207\244\354\262\325\210t\2738\302\226\a\357\250\347\036`\373\216q\257g0\240\327\375\323\244\251\320X\206\261g\330;q\241C\266\232L\020\020\206\026\034T\330gN\031*\022\036\032\241\271mH\304\272\376\203\242R\344\242|\375\260\'\363N(\203*c\245]\311\t\204!\330\250\265T\241u \312^b\a!\275\320\020Z\353\344\206\217*\264\350\036s\240\206\210\247K\372,W:\205\321!o\206\035\306\370D\021\252\352Ql\246\255D_\r\220\353\252\t!\021#kE\265\021{N>!\2176)[\240mR\244\323*\204\341\t\006\2574\312\327\2718+\a\374\024\023i\001#\311X\360\240\376oCcce\005\233\350\221iAg\017/Iv\252\030o)#o4 ?\373H\374\372.8\244#\312\201\334\177\270\223\\\233\240h\202H\n3\211)\2079\352!\033\245\0263\242\025\204\027\316\273Z\236\037\177\251\356\'\322\345Q\307\216\025H\275\354`\341n[g\v\271W\377o\3107\002\264\035\244\037\342\021\323\277[\332D\377s<QJG\003\226\272\301\310\024.\021\213q\351\314q\244\316\253\317\370\225\246\006\002\345\037P/j\2500\322D|T\211<\2468<\340\254\270\374c\311s\217q2\361\257\203\351v\2066\311r\315\250\302\371\177\227D\345/\355n\341\360\263\016\240\303\004\232h\324+&\242@Q\017\034\v\243\361\376\231\200\027\332\344\313\037pu\272\250sL\360\333v\242\344DG\301n2t\325\217\223p$oe\342\236~\341\255\363\334yT\334\363\3058Lv=\324\353!\3162La\302\233]nIf*\261\231\310[p\2650\242\275E\324\371\314\346\034~5>\376\265\\tR\236^\303\\\267E,tM\325rO\\\352\006\315E\320gz\221\3351\371\334\264y\024\b9\375\304\205t7]Q\r\300]\204\033[\236\214\303\274\'\024o\360\363\235\243\274\240\255\215\032r\347\343\021\001\321\345\227\307\353\346\001Vz\027\251Y\270\226\325\331\\g&\346T\375\003r\034\353(\3416\205\2534\316\251\ag\225\220\350_7/V,eB\034\n\216xa\213\232\257\364n\321\022)y2\322\217u)\352U\'\234\363t\016\327!\005bgk\354\330\331\326\264 i\342\203\035\257\327\tC\024~\335\324,\206\320\242\353\227R\006DzXK$\366\006\320^\253ing\242\327\262v$c\374\026\302\250\247\365\220\346\247?,\b\343\230\037\231fs\221v\310\t\222I\365H_\377J\032v\004\224\235\334\247\226\212\317\232\340\243\004\270ay\310\254\206t)\204\370\003\036\271\212\231m</\034_\3239\277\214\357F\336>\306\005\365\224p\363p\200\\r~q\273\033dQ\242mE\204\332lx\004\372\033\331\231\277\255\262\212*H{\367\f\031&\'\353\265~b\377\346\005%/\036\206@\230><\237e+\020J_a\001\227T\331@k\245*\374\360\373\240\300\265\256:\337\aT\202\333\242\237\n\035\376\224\201\336\356\ty\005\374N\276z\321\217l\217\343\310\252\026k\330\304\346V*!`\215\016\367\026\002\267A\341T\353\315C\202$V51\360\223Q\\\251\266\316F\200\005\244\351\032\177\026J\017WY\"\031\017\035S,\257\366\2502>y4\331\034o\212\350\362\256M\363\346\314\206\330\344\304\004\201r\215\345\345r\330D\017[\022\"L~H\250\374\023\020\361\353KvL,\\\351l*\033\224M0j\322k3\313\374\203\034\317\257V\253&\'\000\3545\371\350\251\255\000QH\267\321\312\206\345\354\227\237:\237\345a\235\247\361^\301\v\336\264\311]\322\350\205\214\034p\215<0\v\252\000E}E\377\274_\037\032\031\312e7u\260\324o\b\212{\307WE\276*"
}

	at org.apache.hadoop.hdds.scm.XceiverClientSpi.sendCommand(XceiverClientSpi.java:113)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.TestCSMMetrics.runContainerStateMachineMetrics(TestCSMMetrics.java:141)
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.TestCSMMetrics.testContainerStateMachineMetrics(TestCSMMetrics.java:81)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: java.util.concurrent.ExecutionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-E8C554296427->a7326c16-2bb8-4407-aeed-aa800b5e9183@group-D397A5B8FCF6, cid=1, seq=1*, RW, cmdType: WriteChunk
traceID: ""
containerID: 1571646715189
datanodeUuid: "a7326c16-2bb8-4407-aeed-aa800b5e9183"
writeChunk {
  blockID {
    containerID: 1571646715189
    localID: 1571646715191
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "1571646715191.data.0"
    offset: 0
    len: 1024
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\025\317\362\255"
    }
  }
}
, data.size=1024 for 180 attempts with RetryLimited(maxAttempts=180, sleepTime=1000ms)
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1895)
	at org.apache.hadoop.hdds.scm.XceiverClientSpi.sendCommand(XceiverClientSpi.java:110)
	... 27 more
Caused by: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-E8C554296427->a7326c16-2bb8-4407-aeed-aa800b5e9183@group-D397A5B8FCF6, cid=1, seq=1*, RW, cmdType: WriteChunk
traceID: ""
containerID: 1571646715189
datanodeUuid: "a7326c16-2bb8-4407-aeed-aa800b5e9183"
writeChunk {
  blockID {
    containerID: 1571646715189
    localID: 1571646715191
    blockCommitSequenceId: 0
  }
  chunkData {
    chunkName: "1571646715191.data.0"
    offset: 0
    len: 1024
    checksumData {
      type: CRC32
      bytesPerChecksum: 1048576
      checksums: "\025\317\362\255"
    }
  }
}
, data.size=1024 for 180 attempts with RetryLimited(maxAttempts=180, sleepTime=1000ms)
	at org.apache.ratis.client.impl.RaftClientImpl.noMoreRetries(RaftClientImpl.java:271)
	at org.apache.ratis.client.impl.OrderedAsync.handleAsyncRetryFailure(OrderedAsync.java:138)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$sendRequest$10(OrderedAsync.java:230)
	at java.util.concurrent.CompletableFuture.uniExceptionally(CompletableFuture.java:870)
	at java.util.concurrent.CompletableFuture.uniExceptionallyStage(CompletableFuture.java:884)
	at java.util.concurrent.CompletableFuture.exceptionally(CompletableFuture.java:2196)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequest(OrderedAsync.java:221)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequestWithRetry(OrderedAsync.java:169)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:278)
	at org.apache.ratis.util.SlidingWindow$Client.retry(SlidingWindow.java:294)
	at org.apache.ratis.client.impl.OrderedAsync.lambda$scheduleWithTimeout$7(OrderedAsync.java:195)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:113)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:133)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:50)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:91)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.protocol.AlreadyClosedException: client-E8C554296427->a7326c16-2bb8-4407-aeed-aa800b5e9183 is closed.
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient$AsyncStreamObservers.onNext(GrpcClientProtocolClient.java:307)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:68)
	at org.apache.ratis.client.impl.OrderedAsync.sendRequest(OrderedAsync.java:208)
	... 15 more

